

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ecoli.library.sim_data &mdash; Vivarium E. coli 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Vivarium E. coli
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../stores.html">Stores</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../composites.html">Composites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../experiments.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hpc.html">HPC Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gcloud.html">Google Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ci.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pycharm.html">PyCharm Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/api_ref.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Vivarium E. coli</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">ecoli.library.sim_data</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ecoli.library.sim_data</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">binascii</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">TYPE_CHECKING</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">vivarium.library.units</span><span class="w"> </span><span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">vivunits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">wholecell.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">units</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">wholecell.utils.unit_struct_array</span><span class="w"> </span><span class="kn">import</span> <span class="n">UnitStructArray</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">wholecell.utils.fitting</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">wholecell.utils.filepath</span><span class="w"> </span><span class="kn">import</span> <span class="n">ROOT_PATH</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">ecoli.processes.polypeptide_elongation</span><span class="w"> </span><span class="kn">import</span> <span class="n">MICROMOLAR_UNITS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ecoli.library.parameters</span><span class="w"> </span><span class="kn">import</span> <span class="n">param_store</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ecoli.library.initial_conditions</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">calculate_cell_mass</span><span class="p">,</span>
    <span class="n">initialize_bulk_counts</span><span class="p">,</span>
    <span class="n">initialize_trna_charging</span><span class="p">,</span>
    <span class="n">initialize_unique_molecules</span><span class="p">,</span>
    <span class="n">set_small_molecule_counts</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">reconstruction.ecoli.simulation_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationDataEcoli</span>

<span class="n">RAND_MAX</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">31</span>


<div class="viewcode-block" id="LoadSimData">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">LoadSimData</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">sim_data_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">max_duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">fixed_media</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">media_timeline</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;minimal&quot;</span><span class="p">),</span>
        <span class="p">),</span>  <span class="c1"># have to change both media_timeline and condition</span>
        <span class="n">condition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;basal&quot;</span><span class="p">,</span>
        <span class="n">trna_charging</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">ppgpp_regulation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mar_regulon</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">process_configs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">amp_lysis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">initial_state_gaussian</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">superhelical_density</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">recycle_stalled_elongation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mechanistic_replisome</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">trna_attenuation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">variable_elongation_transcription</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">variable_elongation_translation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">mechanistic_translation_supply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mechanistic_aa_transport</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">translation_supply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">aa_supply_in_charging</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">disable_ppgpp_elongation_inhibition</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">emit_unique</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads simulation data generated by the ParCa</span>
<span class="sd">        (:py:func:`~reconstruction.ecoli.fit_sim_data_1.fitSimData_1`,</span>
<span class="sd">        runscript located at :py:mod:`runscripts.parca`) and extracts</span>
<span class="sd">        parameters for each process. Typically instantiated by</span>
<span class="sd">        :py:class:`~ecoli.composites.ecoli_master.Ecoli` with</span>
<span class="sd">        keyword arguments given by the config loaded by</span>
<span class="sd">        :py:class:`~ecoli.experiments.ecoli_master_sim.EcoliSim`.</span>

<span class="sd">        Args:</span>
<span class="sd">            sim_data_path: Path to simulation data pickle file</span>
<span class="sd">            seed: Used to deterministically seed all random number</span>
<span class="sd">                generators. Simulations with the same seed will yield</span>
<span class="sd">                the same output.</span>
<span class="sd">            max_duration: Maximum duration of single cell simulation (seconds)</span>
<span class="sd">            media_timeline: Iterable of tuples where the first element of</span>
<span class="sd">                each tuple is the time to start using a certain media and the</span>
<span class="sd">                second element is a string corresponding to one of the media</span>
<span class="sd">                options in ``self.sim_data.external_state.saved_media``</span>
<span class="sd">            trna_charging: Use steady-state charging model</span>
<span class="sd">                (:py:class:`~ecoli.processes.polypeptide_elongation.SteadyStateElongationModel`)</span>
<span class="sd">                in :py:class:`~ecoli.processes.polypeptide_elongation.PolypeptideElongation`</span>
<span class="sd">            ppgpp_regulation: Enable growth rate control using ppGpp in</span>
<span class="sd">                polypeptide elongation and transcript initiation</span>
<span class="sd">            mar_regulon: Enable tetracycline-related transcriptional regulation</span>
<span class="sd">                of antibiotic resistance genes by the mar operon</span>
<span class="sd">            process_configs: Mapping of process names to config dictionaries,</span>
<span class="sd">                currently only used to configure :py:class:`~ecoli.processes.rna_interference.RnaInterference`</span>
<span class="sd">            amp_lysis: Enable ampicillin-induced lysis, adds ampicillin and</span>
<span class="sd">                hydrolyzed ampicillin to bulk molecule store</span>
<span class="sd">            initial_state_gaussian: If the simulation is configured to generate an</span>
<span class="sd">                initial state from pickled simulation data (see option 3 in</span>
<span class="sd">                :py:meth:`~ecoli.composites.ecoli_master.Ecoli.initial_state`),</span>
<span class="sd">                enabling this adds Gaussian noise to the generated state</span>
<span class="sd">            superhelical_density: Enables superhelical density calculations on</span>
<span class="sd">                ``(&#39;unique&#39;, &#39;chromosomal_segment)&#39;`` molecules in</span>
<span class="sd">                :py:class:`~ecoli.processes.chromosome_structure.ChromosomeStructure`</span>
<span class="sd">            mechanistic_replisome: Ensures that there are adequate replisome</span>
<span class="sd">                subunits to initiate each round of chromosome replication in</span>
<span class="sd">                :py:class:`~ecoli.processes.chromosome_replication.ChromosomeReplication`</span>
<span class="sd">            recycle_stalled_elongation: Free up RNAPs and nucleotides for</span>
<span class="sd">                stalled transcripts in</span>
<span class="sd">                :py:class:`~ecoli.processes.transcript_elongation.TranscriptElongation`</span>
<span class="sd">            trna_attenuation: Implements `attenuation &lt;https://en.wikipedia.org/wiki/Attenuator_(genetics)&gt;`_</span>
<span class="sd">                in :py:class:`~ecoli.processes.transcript_initiation.TranscriptInitiation`</span>
<span class="sd">                and :py:class:`~ecoli.processes.transcript_elongation.TranscriptElongation`</span>
<span class="sd">            variable_elongation_transcription: Allow different elongation rate for different transcripts</span>
<span class="sd">                (currently increases rates for rRNA, see</span>
<span class="sd">                :py:meth:`~reconstruction.ecoli.dataclasses.process.transcription.Transcription.make_elongation_rates`).</span>
<span class="sd">                Usually set this consistently for ParCa and simulation.</span>
<span class="sd">                :py:class:`~ecoli.processes.transcript_initiation.TranscriptInitiation`</span>
<span class="sd">                Usually set this consistently for ParCa and simulation.</span>
<span class="sd">            variable_elongation_translation: Allow different polypeptides to</span>
<span class="sd">                have different translation rates (currently increases rates for</span>
<span class="sd">                ribosomal proteins, see</span>
<span class="sd">                :py:meth:`~reconstruction.ecoli.dataclasses.process.translation.Translation.make_elongation_rates`).</span>
<span class="sd">                Usually set this consistently for ParCa and simulation.</span>
<span class="sd">            mechanistic_translation_supply: Calculate charged tRNA supply using</span>
<span class="sd">                starting amino acid concentration only based on mechanistic</span>
<span class="sd">                synthesis and supply in</span>
<span class="sd">                :py:class:`~ecoli.processes.polypeptide_elongation.PolypeptideElongation`</span>
<span class="sd">                when ``trna_charging`` is ``True``</span>
<span class="sd">            mechanistic_aa_transport: Constrain amino acid uptake based on</span>
<span class="sd">                external concentrations and exchange rates in</span>
<span class="sd">                :py:class:`~ecoli.processes.metabolism.Metabolism`</span>
<span class="sd">            translation_supply: Use :py:class:`~ecoli.processes.polypeptide_elongation.TranslationSupplyElongationModel`</span>
<span class="sd">                in :py:class:`~ecoli.processes.polypeptide_elongation.PolypeptideElongation`.</span>
<span class="sd">                Superseded by ``trna_charging``</span>
<span class="sd">            aa_supply_in_charging: Calculate charged tRNA supply from each sub</span>
<span class="sd">                time step while solving the charging steady state in</span>
<span class="sd">                :py:class:`~ecoli.processes.polypeptide_elongation.PolypeptideElongation`</span>
<span class="sd">                when ``trna_charging`` is ``True``</span>
<span class="sd">            disable_ppgpp_elongation_inhibition: Turn off ppGpp-mediated</span>
<span class="sd">                inhibition in :py:class:`~ecoli.processes.polypeptide_elongation.PolypeptideElongation`</span>
<span class="sd">                when ``trna_charging`` is ``True``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_duration</span> <span class="o">=</span> <span class="n">max_duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="c1"># Iterable of tuples with the format (time, media_id)</span>
        <span class="k">if</span> <span class="n">condition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span>

        <span class="k">if</span> <span class="n">fixed_media</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">media_timeline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">media_timeline</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">fixed_media</span><span class="p">),)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">media_timeline</span> <span class="o">=</span> <span class="n">media_timeline</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trna_charging</span> <span class="o">=</span> <span class="n">trna_charging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ppgpp_regulation</span> <span class="o">=</span> <span class="n">ppgpp_regulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_state_gaussian</span> <span class="o">=</span> <span class="n">initial_state_gaussian</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">superhelical_density</span> <span class="o">=</span> <span class="n">superhelical_density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_replisome</span> <span class="o">=</span> <span class="n">mechanistic_replisome</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trna_attenuation</span> <span class="o">=</span> <span class="n">trna_attenuation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variable_elongation_transcription</span> <span class="o">=</span> <span class="n">variable_elongation_transcription</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variable_elongation_translation</span> <span class="o">=</span> <span class="n">variable_elongation_translation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_translation_supply</span> <span class="o">=</span> <span class="n">mechanistic_translation_supply</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_aa_transport</span> <span class="o">=</span> <span class="n">mechanistic_aa_transport</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">translation_supply</span> <span class="o">=</span> <span class="n">translation_supply</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aa_supply_in_charging</span> <span class="o">=</span> <span class="n">aa_supply_in_charging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disable_ppgpp_elongation_inhibition</span> <span class="o">=</span> <span class="n">disable_ppgpp_elongation_inhibition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recycle_stalled_elongation</span> <span class="o">=</span> <span class="n">recycle_stalled_elongation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span> <span class="o">=</span> <span class="n">emit_unique</span>

        <span class="c1"># NEW to vivarium-ecoli: Whether to lump miscRNA with mRNAs</span>
        <span class="c1"># when calculating degradation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">degrade_misc</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># load sim_data</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">sim_data_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim_data_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">:</span> <span class="s2">&quot;SimulationDataEcoli&quot;</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sim_data_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">condition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span>

        <span class="c1"># Used by processes to apply submass updates to correct unique attr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submass_indices</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;massDiff_</span><span class="si">{</span><span class="n">submass</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">idx</span>
            <span class="k">for</span> <span class="n">submass</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">submass_name_to_index</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="c1"># Logic to handle internal shifts</span>
        <span class="k">if</span> <span class="s2">&quot;agent_id&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span> <span class="s2">&quot;internal_shift_dict&quot;</span><span class="p">):</span>
            <span class="n">generation</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;agent_id&quot;</span><span class="p">])</span>
            <span class="n">func_to_apply</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">func_params</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">for</span> <span class="n">shift_gen</span><span class="p">,</span> <span class="p">(</span>
                <span class="n">shift_func</span><span class="p">,</span>
                <span class="n">shift_params</span><span class="p">,</span>
            <span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_shift_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">generation</span> <span class="o">&gt;=</span> <span class="n">shift_gen</span><span class="p">:</span>
                    <span class="n">func_to_apply</span> <span class="o">=</span> <span class="n">shift_func</span>
                    <span class="n">func_params</span> <span class="o">=</span> <span class="n">shift_params</span>
            <span class="k">if</span> <span class="n">func_to_apply</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">func_to_apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span> <span class="o">*</span><span class="n">func_params</span><span class="p">)</span>

        <span class="c1"># NEW to vivarium-ecoli</span>
        <span class="c1"># Changes gene expression upon tetracycline exposure</span>
        <span class="c1"># Note: Incompatible with operons because there are genes</span>
        <span class="c1"># that are part of the same operon but have different changes</span>
        <span class="c1"># in expression under tetracycline exposure (e.g. marRAB)</span>
        <span class="k">if</span> <span class="n">mar_regulon</span><span class="p">:</span>
            <span class="c1"># Define aliases to reduce code verbosity</span>
            <span class="n">treg_alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span>
            <span class="n">bulk_mol_alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span>
            <span class="n">eq_alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span>

            <span class="c1"># Assume marA (PD00365) controls the entire tetracycline</span>
            <span class="c1"># gene expression program and marR (CPLX0-7710) is inactivated</span>
            <span class="c1"># by complexation with tetracycline</span>
            <span class="n">treg_alias</span><span class="o">.</span><span class="n">tf_ids</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;PD00365&quot;</span><span class="p">,</span> <span class="s2">&quot;CPLX0-7710&quot;</span><span class="p">]</span>
            <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">treg_alias</span><span class="o">.</span><span class="n">tf_to_tf_type</span><span class="p">[</span><span class="s2">&quot;PD00365&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0CS&quot;</span>
            <span class="n">treg_alias</span><span class="o">.</span><span class="n">tf_to_tf_type</span><span class="p">[</span><span class="s2">&quot;CPLX0-7710&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1CS&quot;</span>
            <span class="n">treg_alias</span><span class="o">.</span><span class="n">active_to_bound</span><span class="p">[</span><span class="s2">&quot;CPLX0-7710&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;marR-tet&quot;</span>

            <span class="c1"># Add marA and marR to pPromoterBound dict for initial state generation</span>
            <span class="k">for</span> <span class="n">bound_probs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">pPromoterBound</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">bound_probs</span><span class="p">[</span><span class="s2">&quot;CPLX0-7710&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">bound_probs</span><span class="p">[</span><span class="s2">&quot;PD00365&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># Expand promoter bound_TF field for marA and marR</span>
            <span class="n">curr_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">unique_molecule</span><span class="o">.</span><span class="n">unique_molecule_definitions</span><span class="p">[</span>
                <span class="s2">&quot;promoter&quot;</span>
            <span class="p">][</span><span class="s2">&quot;bound_TF&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">unique_molecule</span><span class="o">.</span><span class="n">unique_molecule_definitions</span><span class="p">[</span>
                <span class="s2">&quot;promoter&quot;</span>
            <span class="p">][</span><span class="s2">&quot;bound_TF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">curr_size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

            <span class="c1"># TU index of genes for outer membrane proteins, regulators,</span>
            <span class="c1"># and inner membrane transporters</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">de_genes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ROOT_PATH</span><span class="p">,</span> <span class="s2">&quot;data/marA_binding/gene_fc.csv&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                    <span class="s2">&quot;Please run data/marA_binding/get_TU_ID.py first to generate the gene_fc.csv file.&quot;</span>
                <span class="p">)</span>
            <span class="n">new_deltaI</span> <span class="o">=</span> <span class="n">de_genes</span><span class="p">[</span><span class="s2">&quot;TU_idx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">new_deltaJ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">24</span><span class="p">]</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>
            <span class="c1"># Values were chosen to recapitulate mRNA fold change when exposed</span>
            <span class="c1"># to 1.5 mg/L tetracycline (Viveiros et al. 2007)</span>
            <span class="n">new_deltaV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="mf">1.76e-03</span><span class="p">,</span>
                    <span class="mf">2.21e-05</span><span class="p">,</span>
                    <span class="mf">2.44e-05</span><span class="p">,</span>
                    <span class="mf">2.10e-06</span><span class="p">,</span>
                    <span class="mf">4.11e-06</span><span class="p">,</span>
                    <span class="mf">7.80e-06</span><span class="p">,</span>
                    <span class="mf">5.40e-04</span><span class="p">,</span>
                    <span class="mf">7.42e-06</span><span class="p">,</span>
                    <span class="mf">1.51e-06</span><span class="p">,</span>
                    <span class="mf">2.95e-05</span><span class="p">,</span>
                    <span class="mf">2.02e-05</span><span class="p">,</span>
                    <span class="mf">1.96e-04</span><span class="p">,</span>
                    <span class="mf">5.77e-05</span><span class="p">,</span>
                    <span class="mf">2.34e-04</span><span class="p">,</span>
                    <span class="mf">2.04e-06</span><span class="p">,</span>
                    <span class="mf">1.58e-07</span><span class="p">,</span>
                    <span class="mf">8.89e-08</span><span class="p">,</span>
                    <span class="mf">8.52e-07</span><span class="p">,</span>
                    <span class="mf">8.09e-06</span><span class="p">,</span>
                    <span class="mf">1.68e-08</span><span class="p">,</span>
                    <span class="mf">7.17e-08</span><span class="p">,</span>
                    <span class="mf">8.08e-06</span><span class="p">,</span>
                    <span class="mf">1.40e-08</span><span class="p">,</span>
                    <span class="o">-</span><span class="mf">5.30e-07</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;deltaI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span><span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;deltaI&quot;</span><span class="p">],</span> <span class="n">new_deltaI</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;deltaJ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span><span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;deltaJ&quot;</span><span class="p">],</span> <span class="n">new_deltaJ</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;deltaV&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span><span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;deltaV&quot;</span><span class="p">],</span> <span class="n">new_deltaV</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="c1"># Add mass data for tetracycline, marR-tet, and 30s-tet</span>
            <span class="n">bulk_data</span> <span class="o">=</span> <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span><span class="o">.</span><span class="n">fullArray</span><span class="p">()</span>
            <span class="n">marR_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bulk_data</span><span class="p">[</span><span class="n">bulk_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CPLX0-7710[c]&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">free_30s_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">bulk_data</span><span class="p">[</span><span class="n">bulk_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CPLX0-3953[c]&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">tet_mass</span> <span class="o">=</span> <span class="n">param_store</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s2">&quot;tetracycline&quot;</span><span class="p">,</span> <span class="s2">&quot;mass&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">magnitude</span>
            <span class="n">tet_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tet_mass</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">bulk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">bulk_data</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="s2">&quot;marR-tet[c]&quot;</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">marR_mass</span> <span class="o">+</span> <span class="n">tet_mass</span><span class="p">,),</span>
                        <span class="p">(</span><span class="s2">&quot;tetracycline[p]&quot;</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">tet_mass</span><span class="p">,),</span>
                        <span class="p">(</span><span class="s2">&quot;tetracycline[c]&quot;</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">tet_mass</span><span class="p">,),</span>
                        <span class="p">(</span><span class="s2">&quot;CPLX0-3953-tetracycline[c]&quot;</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">free_30s_mass</span> <span class="o">+</span> <span class="n">tet_mass</span><span class="p">,),</span>
                    <span class="p">],</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="n">bulk_data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">bulk_units</span> <span class="o">=</span> <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span><span class="o">.</span><span class="n">fullUnits</span><span class="p">()</span>
            <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span> <span class="o">=</span> <span class="n">UnitStructArray</span><span class="p">(</span><span class="n">bulk_data</span><span class="p">,</span> <span class="n">bulk_units</span><span class="p">)</span>

            <span class="c1"># Add equilibrium reaction for marR-tetracycline and</span>
            <span class="c1"># reinitialize self.sim_data.process.equilibrium variables</span>
            <span class="n">stoich_matrix_shape</span> <span class="o">=</span> <span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrix</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrixI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrixI</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">stoich_matrix_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stoich_matrix_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrixJ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span><span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrixJ</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">stoich_matrix_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)]</span>
            <span class="p">)</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrixV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span><span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrixV</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
            <span class="p">)</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">molecule_names</span> <span class="o">+=</span> <span class="p">[</span>
                <span class="s2">&quot;CPLX0-7710[c]&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tetracycline[c]&quot;</span><span class="p">,</span>
                <span class="s2">&quot;marR-tet[c]&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">ids_complexes</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">eq_alias</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">eq_alias</span><span class="o">.</span><span class="n">stoich_matrix</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">rxn_ids</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;marR-tet&quot;</span><span class="p">]</span>
            <span class="c1"># All existing equilibrium rxns use a forward rate of 1</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">rates_fwd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">eq_alias</span><span class="o">.</span><span class="n">rates_fwd</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">])])</span>
            <span class="c1"># Existing equilibrium rxns use a default reverse rate of 1e-6</span>
            <span class="c1"># This happens to nearly perfectly yield full MarR inactivation</span>
            <span class="c1"># at 1.5 mg/L external tetracycline</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">rates_rev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">eq_alias</span><span class="o">.</span><span class="n">rates_rev</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1e-6</span><span class="p">])])</span>

            <span class="c1"># Mass balance matrix</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrixMass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrixMass</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">marR_mass</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">tet_mass</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="p">(</span><span class="n">marR_mass</span> <span class="o">+</span> <span class="n">tet_mass</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()]</span>
                    <span class="p">),</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">balance_matrix</span> <span class="o">=</span> <span class="n">eq_alias</span><span class="o">.</span><span class="n">stoich_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">eq_alias</span><span class="o">.</span><span class="n">mass_matrix</span><span class="p">()</span>

            <span class="c1"># Find the mass balance of each equation in the balanceMatrix</span>
            <span class="n">massBalanceArray</span> <span class="o">=</span> <span class="n">eq_alias</span><span class="o">.</span><span class="n">mass_balance</span><span class="p">()</span>

            <span class="c1"># The stoichometric matrix should balance out to numerical zero.</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">massBalanceArray</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-9</span>

            <span class="c1"># Build matrices</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">_populateDerivativeAndJacobian</span><span class="p">()</span>
            <span class="n">eq_alias</span><span class="o">.</span><span class="n">_stoichMatrix</span> <span class="o">=</span> <span class="n">eq_alias</span><span class="o">.</span><span class="n">stoich_matrix</span><span class="p">()</span>

        <span class="c1"># NEW to vivarium-ecoli</span>
        <span class="c1"># Append new RNA IDs and degradation rates for sRNA-mRNA duplexes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">process_configs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">rnai_data</span> <span class="o">=</span> <span class="n">process_configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ecoli-rna-interference&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rnai_data</span><span class="p">:</span>
                <span class="c1"># Define aliases to reduce code verbosity</span>
                <span class="n">ts_alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span>
                <span class="n">bulk_mol_alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span>
                <span class="n">treg_alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">duplex_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rnai_data</span><span class="p">[</span><span class="s2">&quot;duplex_ids&quot;</span><span class="p">])</span>
                <span class="n">n_duplex_rnas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">duplex_ids</span><span class="p">)</span>
                <span class="n">duplex_deg_rates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rnai_data</span><span class="p">[</span><span class="s2">&quot;duplex_deg_rates&quot;</span><span class="p">])</span>
                <span class="n">duplex_km</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rnai_data</span><span class="p">[</span><span class="s2">&quot;duplex_km&quot;</span><span class="p">])</span>
                <span class="n">duplex_na</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_duplex_rnas</span><span class="p">)</span>
                <span class="c1"># Mark duplexes as miscRNAs so they are degraded appropriately</span>
                <span class="n">duplex_is_miscRNA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_duplex_rnas</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">srna_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rnai_data</span><span class="p">[</span><span class="s2">&quot;srna_ids&quot;</span><span class="p">])</span>
                <span class="n">target_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rnai_data</span><span class="p">[</span><span class="s2">&quot;target_ids&quot;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">target_tu_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_ids</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">binding_probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rnai_data</span><span class="p">[</span><span class="s2">&quot;binding_probs&quot;</span><span class="p">])</span>

                <span class="c1"># Get duplex length, ACGU content, molecular weight, and sequence</span>
                <span class="n">duplex_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_duplex_rnas</span><span class="p">)</span>
                <span class="n">duplex_ACGU</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_duplex_rnas</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
                <span class="n">duplex_mw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_duplex_rnas</span><span class="p">)</span>
                <span class="n">cistron_data</span> <span class="o">=</span> <span class="n">ts_alias</span><span class="o">.</span><span class="n">cistron_data</span><span class="o">.</span><span class="n">fullArray</span><span class="p">()</span>
                <span class="n">cistron_tu_mapping</span> <span class="o">=</span> <span class="n">ts_alias</span><span class="o">.</span><span class="n">cistron_tu_mapping_matrix</span>
                <span class="n">rna_data</span> <span class="o">=</span> <span class="n">ts_alias</span><span class="o">.</span><span class="n">rna_data</span><span class="o">.</span><span class="n">fullArray</span><span class="p">()</span>
                <span class="n">rna_units</span> <span class="o">=</span> <span class="n">ts_alias</span><span class="o">.</span><span class="n">rna_data</span><span class="o">.</span><span class="n">fullUnits</span><span class="p">()</span>
                <span class="n">rna_sequences</span> <span class="o">=</span> <span class="n">ts_alias</span><span class="o">.</span><span class="n">transcription_sequences</span>
                <span class="n">duplex_sequences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_duplex_rnas</span><span class="p">,</span> <span class="n">rna_sequences</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">srna_id</span><span class="p">,</span> <span class="n">target_id</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">srna_ids</span><span class="p">,</span> <span class="n">target_ids</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="c1"># Use first match for each sRNA and target mRNA</span>
                    <span class="n">srna_tu_id</span> <span class="o">=</span> <span class="n">cistron_tu_mapping</span><span class="p">[</span>
                        <span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">srna_id</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">target_tu_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cistron_tu_mapping</span><span class="p">[</span>
                        <span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">target_id</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">duplex_ACGU</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;counts_ACGU&quot;</span><span class="p">][</span><span class="n">srna_tu_id</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;counts_ACGU&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">target_tu_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="p">)</span>
                    <span class="n">duplex_mw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;mw&quot;</span><span class="p">][</span><span class="n">srna_tu_id</span><span class="p">]</span>
                        <span class="o">+</span> <span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;mw&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">target_tu_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="p">)</span>
                    <span class="n">srna_length</span> <span class="o">=</span> <span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">][</span><span class="n">srna_tu_id</span><span class="p">]</span>
                    <span class="n">target_length</span> <span class="o">=</span> <span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">target_tu_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">duplex_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">srna_length</span> <span class="o">+</span> <span class="n">target_length</span>
                    <span class="k">if</span> <span class="n">duplex_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">duplex_sequences</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="c1"># Extend columns in sequence arrays to accomodate duplexes</span>
                        <span class="c1"># where the sum of the RNA lengths &gt; # of columns</span>
                        <span class="n">extend_length</span> <span class="o">=</span> <span class="n">duplex_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">duplex_sequences</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">extend_duplex_sequences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
                            <span class="p">(</span><span class="n">duplex_sequences</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extend_length</span><span class="p">),</span>
                            <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">dtype</span><span class="o">=</span><span class="n">duplex_sequences</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">duplex_sequences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">duplex_sequences</span><span class="p">,</span> <span class="n">extend_duplex_sequences</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                        <span class="p">)</span>
                        <span class="n">extend_rna_sequences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
                            <span class="p">(</span><span class="n">rna_sequences</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extend_length</span><span class="p">),</span>
                            <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">dtype</span><span class="o">=</span><span class="n">rna_sequences</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">rna_sequences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">rna_sequences</span><span class="p">,</span> <span class="n">extend_rna_sequences</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                        <span class="p">)</span>
                    <span class="n">duplex_sequences</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">srna_length</span><span class="p">]</span> <span class="o">=</span> <span class="n">rna_sequences</span><span class="p">[</span><span class="n">srna_tu_id</span><span class="p">][</span>
                        <span class="p">:</span><span class="n">srna_length</span>
                    <span class="p">]</span>
                    <span class="n">duplex_sequences</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">srna_length</span> <span class="p">:</span> <span class="n">srna_length</span> <span class="o">+</span> <span class="n">target_length</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">rna_sequences</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">target_tu_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]][:</span><span class="n">target_length</span><span class="p">]</span>
                    <span class="p">)</span>

                <span class="c1"># Make duplex metadata visible to all RNA-related processes</span>
                <span class="n">old_n_rnas</span> <span class="o">=</span> <span class="n">rna_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">rna_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">rna_data</span><span class="p">,</span> <span class="n">old_n_rnas</span> <span class="o">+</span> <span class="n">n_duplex_rnas</span><span class="p">)</span>
                <span class="n">rna_sequences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span>
                    <span class="n">rna_sequences</span><span class="p">,</span> <span class="p">(</span><span class="n">old_n_rnas</span> <span class="o">+</span> <span class="n">n_duplex_rnas</span><span class="p">,</span> <span class="n">rna_sequences</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_rna</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                    <span class="nb">zip</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">duplex_ids</span><span class="p">,</span>
                        <span class="n">duplex_deg_rates</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_lengths</span><span class="p">,</span>
                        <span class="n">duplex_ACGU</span><span class="p">,</span>
                        <span class="n">duplex_mw</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_km</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_is_miscRNA</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                        <span class="n">duplex_na</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">rna_data</span><span class="p">[</span><span class="n">old_n_rnas</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_rna</span>
                    <span class="n">rna_sequences</span><span class="p">[</span><span class="n">old_n_rnas</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">duplex_sequences</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">ts_alias</span><span class="o">.</span><span class="n">transcription_sequences</span> <span class="o">=</span> <span class="n">rna_sequences</span>
                <span class="n">ts_alias</span><span class="o">.</span><span class="n">rna_data</span> <span class="o">=</span> <span class="n">UnitStructArray</span><span class="p">(</span><span class="n">rna_data</span><span class="p">,</span> <span class="n">rna_units</span><span class="p">)</span>

                <span class="c1"># Add bulk mass data for duplexes</span>
                <span class="n">bulk_data</span> <span class="o">=</span> <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span><span class="o">.</span><span class="n">fullArray</span><span class="p">()</span>
                <span class="n">bulk_units</span> <span class="o">=</span> <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span><span class="o">.</span><span class="n">fullUnits</span><span class="p">()</span>
                <span class="n">old_n_bulk</span> <span class="o">=</span> <span class="n">bulk_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">bulk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">bulk_data</span><span class="p">,</span> <span class="n">bulk_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">n_duplex_rnas</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">duplex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">duplex_ids</span><span class="p">):</span>
                    <span class="n">duplex_submasses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
                    <span class="n">duplex_submasses</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">duplex_mw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">bulk_data</span><span class="p">[</span><span class="n">old_n_bulk</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">duplex</span><span class="p">,</span> <span class="n">duplex_submasses</span><span class="p">)</span>
                <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span> <span class="o">=</span> <span class="n">UnitStructArray</span><span class="p">(</span><span class="n">bulk_data</span><span class="p">,</span> <span class="n">bulk_units</span><span class="p">)</span>

                <span class="c1"># Add filler transcription data for duplex RNAs to prevent errors</span>
                <span class="n">treg_alias</span><span class="o">.</span><span class="n">basal_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">treg_alias</span><span class="o">.</span><span class="n">basal_prob</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">treg_alias</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">[</span><span class="s2">&quot;shape&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">)</span>

                <span class="c1"># Set flag so miscRNA duplexes are degraded together with mRNAs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">degrade_misc</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="c1"># Resize cistron-TU mapping matrix</span>
                <span class="n">curr_shape</span> <span class="o">=</span> <span class="n">ts_alias</span><span class="o">.</span><span class="n">cistron_tu_mapping_matrix</span><span class="o">.</span><span class="n">_shape</span>
                <span class="n">ts_alias</span><span class="o">.</span><span class="n">cistron_tu_mapping_matrix</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">curr_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">curr_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">n_duplex_rnas</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="c1"># Add duplexes to RNA synth prob calculations</span>
                <span class="n">ts_alias</span><span class="o">.</span><span class="n">exp_free</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">ts_alias</span><span class="o">.</span><span class="n">exp_free</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_duplex_rnas</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">ts_alias</span><span class="o">.</span><span class="n">exp_ppgpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">ts_alias</span><span class="o">.</span><span class="n">exp_ppgpp</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_duplex_rnas</span><span class="p">]</span>
                <span class="p">)</span>

        <span class="c1"># NEW to vivarium-ecoli</span>
        <span class="c1"># Add ampicillin to bulk molecules</span>
        <span class="k">if</span> <span class="n">amp_lysis</span><span class="p">:</span>
            <span class="n">bulk_mol_alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span>
            <span class="c1"># Add mass data for ampicillin and hydrolyzed ampicillin</span>
            <span class="n">bulk_data</span> <span class="o">=</span> <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span><span class="o">.</span><span class="n">fullArray</span><span class="p">()</span>
            <span class="n">amp_mass</span> <span class="o">=</span> <span class="n">param_store</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s2">&quot;ampicillin&quot;</span><span class="p">,</span> <span class="s2">&quot;molar_mass&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">magnitude</span>
            <span class="n">amp_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">amp_mass</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">amp_hydro_mass</span> <span class="o">=</span> <span class="n">amp_mass</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="c1"># Include molar mass of water added during hydrolysis</span>
            <span class="n">amp_hydro_mass</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">18</span>
            <span class="n">bulk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">bulk_data</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">(</span><span class="s2">&quot;ampicillin[p]&quot;</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">amp_mass</span><span class="p">,),</span>
                        <span class="p">(</span><span class="s2">&quot;ampicillin_hydrolyzed[p]&quot;</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">amp_hydro_mass</span><span class="p">,),</span>
                    <span class="p">],</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="n">bulk_data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">bulk_units</span> <span class="o">=</span> <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span><span class="o">.</span><span class="n">fullUnits</span><span class="p">()</span>
            <span class="n">bulk_mol_alias</span><span class="o">.</span><span class="n">bulk_data</span> <span class="o">=</span> <span class="n">UnitStructArray</span><span class="p">(</span><span class="n">bulk_data</span><span class="p">,</span> <span class="n">bulk_units</span><span class="p">)</span>

<div class="viewcode-block" id="LoadSimData.get_monomer_counts_indices">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_monomer_counts_indices">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_monomer_counts_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a list of monomer names without location tags, this returns</span>
<span class="sd">        the indices of those monomers in the monomer_counts listener array.</span>
<span class="sd">        The &quot;id&quot; column of reconstruction/ecoli/flat/proteins.tsv contains</span>
<span class="sd">        nearly all supported monomer names.&quot;&quot;&quot;</span>
        <span class="n">monomer_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="c1"># Strip location string (e.g. [c])</span>
        <span class="n">monomer_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[.\]&quot;</span><span class="p">,</span> <span class="n">monomer</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">monomer</span> <span class="ow">in</span> <span class="n">monomer_ids</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">monomer_ids</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span></div>


<div class="viewcode-block" id="LoadSimData.get_mrna_counts_indices">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_mrna_counts_indices">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_mrna_counts_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a list of mRNA names without location tags, this returns</span>
<span class="sd">        the indices of those mRNAs in the mRNA_counts listener array.</span>
<span class="sd">        The &quot;id&quot; column of reconstruction/ecoli/flat/rnas.tsv contains</span>
<span class="sd">        nearly all supported mRNA names.&quot;&quot;&quot;</span>
        <span class="n">is_mrna</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_mRNA&quot;</span><span class="p">]</span>
        <span class="n">mrna_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="n">is_mrna</span><span class="p">]</span>
        <span class="c1"># Strip location string (e.g. [c])</span>
        <span class="n">mrna_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[.\]&quot;</span><span class="p">,</span> <span class="n">mrna</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">mrna</span> <span class="ow">in</span> <span class="n">mrna_ids</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mrna_ids</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span></div>


<div class="viewcode-block" id="LoadSimData.get_rna_indices">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_rna_indices">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rna_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a list of RNA names without location tags, this returns</span>
<span class="sd">        the TU indices of those RNAs (for rna_init_events and rna_synth_prob).</span>
<span class="sd">        The &quot;id&quot; column of reconstruction/ecoli/flat/rnas.tsv contains</span>
<span class="sd">        nearly all supported RNA names.&quot;&quot;&quot;</span>
        <span class="n">rna_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="c1"># Strip location string (e.g. [c])</span>
        <span class="n">rna_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[.\]&quot;</span><span class="p">,</span> <span class="n">mrna</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">mrna</span> <span class="ow">in</span> <span class="n">rna_ids</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rna_ids</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span></div>


<div class="viewcode-block" id="LoadSimData._seedFromName">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData._seedFromName">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_seedFromName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">binascii</span><span class="o">.</span><span class="n">crc32</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span></div>


<div class="viewcode-block" id="LoadSimData.get_config_by_name">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_config_by_name">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_config_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">name_config_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ecoli-tf-binding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tf_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-transcript-initiation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transcript_initiation_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-transcript-elongation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transcript_elongation_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-rna-degradation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rna_degradation_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-polypeptide-initiation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_polypeptide_initiation_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-polypeptide-elongation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_polypeptide_elongation_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-complexation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_complexation_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-two-component-system&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_two_component_system_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-equilibrium&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_equilibrium_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-protein-degradation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_protein_degradation_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-metabolism&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metabolism_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-metabolism-redux&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metabolism_redux_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-metabolism-redux-classic&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metabolism_redux_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-chromosome-replication&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chromosome_replication_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-mass&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-mass-listener&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_listener_config</span><span class="p">,</span>
            <span class="s2">&quot;post-division-mass-listener&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_listener_config</span><span class="p">,</span>
            <span class="s2">&quot;RNA_counts_listener&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rna_counts_listener_config</span><span class="p">,</span>
            <span class="s2">&quot;monomer_counts_listener&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_monomer_counts_listener_config</span><span class="p">,</span>
            <span class="s2">&quot;rna_synth_prob_listener&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rna_synth_prob_listener_config</span><span class="p">,</span>
            <span class="s2">&quot;allocator&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_allocator_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-chromosome-structure&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chromosome_structure_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-rna-interference&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rna_interference_config</span><span class="p">,</span>
            <span class="s2">&quot;tetracycline-ribosome-equilibrium&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tetracycline_ribosome_equilibrium_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-rna-maturation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rna_maturation_config</span><span class="p">,</span>
            <span class="s2">&quot;ecoli-tf-unbinding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tf_unbinding_config</span><span class="p">,</span>
            <span class="s2">&quot;dna_supercoiling_listener&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dna_supercoiling_listener_config</span><span class="p">,</span>
            <span class="s2">&quot;ribosome_data_listener&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ribosome_data_listener_config</span><span class="p">,</span>
            <span class="s2">&quot;rnap_data_listener&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rnap_data_listener_config</span><span class="p">,</span>
            <span class="s2">&quot;unique_molecule_counts&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_unique_molecule_counts_config</span><span class="p">,</span>
            <span class="s2">&quot;exchange_data&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exchange_data_config</span><span class="p">,</span>
            <span class="s2">&quot;media_update&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_media_update_config</span><span class="p">,</span>
            <span class="s2">&quot;bulk-timeline&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bulk_timeline_config</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">name_config_mapping</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">time_step</span><span class="o">=</span><span class="n">time_step</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Process of name </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> is not known to LoadSimData.get_config_by_name&quot;</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="LoadSimData.get_chromosome_replication_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_chromosome_replication_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_chromosome_replication_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">get_dna_critical_mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">get_dna_critical_mass</span>
        <span class="n">doubling_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition_to_doubling_time</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition</span>
        <span class="p">]</span>

        <span class="n">replisome_trimer_subunit_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">getter</span><span class="o">.</span><span class="n">get_submass_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                    <span class="n">units</span><span class="o">.</span><span class="n">fg</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">count</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">replisome_trimer_subunits</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">replisome_monomer_subunit_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">getter</span><span class="o">.</span><span class="n">get_submass_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                    <span class="n">units</span><span class="o">.</span><span class="n">fg</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">count</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">replisome_monomer_subunits</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">replisome_mass_array</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">replisome_trimer_subunit_masses</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">replisome_monomer_subunit_masses</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">chromosome_replication_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;get_dna_critical_mass&quot;</span><span class="p">:</span> <span class="n">get_dna_critical_mass</span><span class="p">,</span>
            <span class="s2">&quot;criticalInitiationMass&quot;</span><span class="p">:</span> <span class="n">get_dna_critical_mass</span><span class="p">(</span><span class="n">doubling_time</span><span class="p">),</span>
            <span class="s2">&quot;nutrientToDoublingTime&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">nutrient_to_doubling_time</span><span class="p">,</span>
            <span class="s2">&quot;replichore_lengths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">replichore_lengths</span><span class="p">,</span>
            <span class="s2">&quot;sequences&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">replication_sequences</span><span class="p">,</span>
            <span class="s2">&quot;polymerized_dntp_weights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">replication_monomer_weights</span><span class="p">,</span>
            <span class="s2">&quot;replication_coordinate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span>
                <span class="s2">&quot;replication_coordinate&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;D_period&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">d_period</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="s2">&quot;replisome_protein_mass&quot;</span><span class="p">:</span> <span class="n">replisome_mass_array</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
            <span class="s2">&quot;no_child_place_holder&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">no_child_place_holder</span><span class="p">,</span>
            <span class="s2">&quot;basal_elongation_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">basal_elongation_rate</span><span class="p">,</span>
            <span class="s2">&quot;make_elongation_rates&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">make_elongation_rates</span><span class="p">,</span>
            <span class="c1"># sim options</span>
            <span class="s2">&quot;mechanistic_replisome&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_replisome</span><span class="p">,</span>
            <span class="c1"># molecules</span>
            <span class="s2">&quot;replisome_trimers_subunits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">replisome_trimer_subunits</span><span class="p">,</span>
            <span class="s2">&quot;replisome_monomers_subunits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">replisome_monomer_subunits</span><span class="p">,</span>
            <span class="s2">&quot;dntps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">dntps</span><span class="p">,</span>
            <span class="s2">&quot;ppi&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppi</span><span class="p">],</span>
            <span class="c1"># random state</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;ChromosomeReplication&quot;</span><span class="p">),</span>
            <span class="s2">&quot;submass_indices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">submass_indices</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">chromosome_replication_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_tf_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_tf_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_tf_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">tf_binding_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;tf_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">tf_ids</span><span class="p">,</span>
            <span class="s2">&quot;rna_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;delta_prob&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">,</span>
            <span class="s2">&quot;n_avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">,</span>
            <span class="s2">&quot;cell_density&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="p">,</span>
            <span class="s2">&quot;p_promoter_bound_tf&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">p_promoter_bound_tf</span><span class="p">,</span>
            <span class="s2">&quot;tf_to_tf_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">tf_to_tf_type</span><span class="p">,</span>
            <span class="s2">&quot;active_to_bound&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">active_to_bound</span><span class="p">,</span>
            <span class="s2">&quot;get_unbound&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">get_unbound</span><span class="p">,</span>
            <span class="s2">&quot;active_to_inactive_tf&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">two_component_system</span><span class="o">.</span><span class="n">active_to_inactive_tf</span><span class="p">,</span>
            <span class="s2">&quot;bulk_molecule_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span>
                <span class="s2">&quot;id&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;bulk_mass_data&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span>
                <span class="s2">&quot;mass&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;TfBinding&quot;</span><span class="p">),</span>
            <span class="s2">&quot;submass_indices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">submass_indices</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">tf_binding_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_transcript_initiation_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_transcript_initiation_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_transcript_initiation_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">transcript_initiation_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;fracActiveRnapDict&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rnapFractionActiveDict</span><span class="p">,</span>
            <span class="s2">&quot;rnaLengths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">],</span>
            <span class="s2">&quot;rnaPolymeraseElongationRateDict&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rnaPolymeraseElongationRateDict</span><span class="p">,</span>
            <span class="s2">&quot;variable_elongation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable_elongation_transcription</span><span class="p">,</span>
            <span class="s2">&quot;make_elongation_rates&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">make_elongation_rates</span><span class="p">,</span>
            <span class="s2">&quot;active_rnap_footprint_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">active_rnap_footprint_size</span><span class="p">,</span>
            <span class="s2">&quot;basal_prob&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">basal_prob</span><span class="p">,</span>
            <span class="s2">&quot;delta_prob&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">delta_prob</span><span class="p">,</span>
            <span class="s2">&quot;get_delta_prob_matrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">get_delta_prob_matrix</span><span class="p">,</span>
            <span class="s2">&quot;perturbations&quot;</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span> <span class="s2">&quot;genetic_perturbations&quot;</span><span class="p">,</span> <span class="p">{}),</span>
            <span class="s2">&quot;rna_data&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">,</span>
            <span class="s2">&quot;idx_rRNA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_rRNA&quot;</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;idx_mRNA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_mRNA&quot;</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;idx_tRNA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_tRNA&quot;</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;idx_rprotein&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span>
                    <span class="s2">&quot;includes_ribosomal_protein&quot;</span>
                <span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;idx_rnap&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;includes_RNAP&quot;</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;rnaSynthProbFractions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rnaSynthProbFraction</span><span class="p">,</span>
            <span class="s2">&quot;rnaSynthProbRProtein&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rnaSynthProbRProtein</span><span class="p">,</span>
            <span class="s2">&quot;rnaSynthProbRnaPolymerase&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rnaSynthProbRnaPolymerase</span><span class="p">,</span>
            <span class="s2">&quot;replication_coordinate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span>
                <span class="s2">&quot;replication_coordinate&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;transcription_direction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span>
                <span class="s2">&quot;is_forward&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;n_avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">,</span>
            <span class="s2">&quot;cell_density&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="p">,</span>
            <span class="s2">&quot;inactive_RNAP&quot;</span><span class="p">:</span> <span class="s2">&quot;APORNAP-CPLX[c]&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ppgpp&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppGpp</span><span class="p">,</span>
            <span class="s2">&quot;synth_prob&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">synth_prob_from_ppgpp</span><span class="p">,</span>
            <span class="s2">&quot;copy_number&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">get_average_copy_number</span><span class="p">,</span>
            <span class="s2">&quot;ppgpp_regulation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppgpp_regulation</span><span class="p">,</span>
            <span class="s2">&quot;get_rnap_active_fraction_from_ppGpp&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">get_rnap_active_fraction_from_ppGpp</span><span class="p">,</span>
            <span class="c1"># attenuation</span>
            <span class="s2">&quot;trna_attenuation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trna_attenuation</span><span class="p">,</span>
            <span class="s2">&quot;attenuated_rna_indices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">attenuated_rna_indices</span><span class="p">,</span>
            <span class="s2">&quot;attenuation_adjustments&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">attenuation_basal_prob_adjustments</span><span class="p">,</span>
            <span class="c1"># random seed</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;TranscriptInitiation&quot;</span><span class="p">),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">transcript_initiation_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_transcript_elongation_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_transcript_elongation_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_transcript_elongation_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">transcript_elongation_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;rnaPolymeraseElongationRateDict&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rnaPolymeraseElongationRateDict</span><span class="p">,</span>
            <span class="s2">&quot;rnaIds&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;rnaLengths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span>
                <span class="s2">&quot;length&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(),</span>
            <span class="s2">&quot;rnaSequences&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">transcription_sequences</span><span class="p">,</span>
            <span class="s2">&quot;ntWeights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">transcription_monomer_weights</span><span class="p">,</span>
            <span class="s2">&quot;endWeight&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">transcription_end_weight</span><span class="p">,</span>
            <span class="s2">&quot;replichore_lengths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">replichore_lengths</span><span class="p">,</span>
            <span class="s2">&quot;is_mRNA&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_mRNA&quot;</span><span class="p">],</span>
            <span class="s2">&quot;ppi&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppi</span><span class="p">,</span>
            <span class="s2">&quot;inactive_RNAP&quot;</span><span class="p">:</span> <span class="s2">&quot;APORNAP-CPLX[c]&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ntp_ids&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ATP[c]&quot;</span><span class="p">,</span> <span class="s2">&quot;CTP[c]&quot;</span><span class="p">,</span> <span class="s2">&quot;GTP[c]&quot;</span><span class="p">,</span> <span class="s2">&quot;UTP[c]&quot;</span><span class="p">],</span>
            <span class="s2">&quot;variable_elongation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable_elongation_transcription</span><span class="p">,</span>
            <span class="s2">&quot;make_elongation_rates&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">make_elongation_rates</span><span class="p">,</span>
            <span class="s2">&quot;fragmentBases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">polymerized_ntps</span><span class="p">,</span>
            <span class="s2">&quot;charged_trnas&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">charged_trna_names</span><span class="p">,</span>
            <span class="c1"># attenuation</span>
            <span class="s2">&quot;trna_attenuation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trna_attenuation</span><span class="p">,</span>
            <span class="s2">&quot;polymerized_ntps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">polymerized_ntps</span><span class="p">,</span>
            <span class="s2">&quot;cell_density&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="p">,</span>
            <span class="s2">&quot;n_avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">,</span>
            <span class="s2">&quot;get_attenuation_stop_probabilities&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">get_attenuation_stop_probabilities</span><span class="p">,</span>
            <span class="s2">&quot;attenuated_rna_indices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">attenuated_rna_indices</span><span class="p">,</span>
            <span class="s2">&quot;location_lookup&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">attenuation_location</span><span class="p">,</span>
            <span class="s2">&quot;recycle_stalled_elongation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">recycle_stalled_elongation</span><span class="p">,</span>
            <span class="c1"># random seed</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;TranscriptElongation&quot;</span><span class="p">),</span>
            <span class="s2">&quot;submass_indices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">submass_indices</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">transcript_elongation_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_rna_degradation_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_rna_degradation_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rna_degradation_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">transcription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span>
        <span class="n">rna_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
        <span class="n">mature_rna_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
        <span class="n">all_rna_ids</span> <span class="o">=</span> <span class="n">rna_ids</span> <span class="o">+</span> <span class="n">mature_rna_ids</span>
        <span class="n">rna_id_to_index</span> <span class="o">=</span> <span class="p">{</span><span class="n">rna_id</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">rna_id</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_rna_ids</span><span class="p">)}</span>
        <span class="n">cistron_ids</span> <span class="o">=</span> <span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">cistron_id_to_index</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">cistron_id</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">cistron_id</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cistron_ids</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">rna_degradation_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;rna_ids&quot;</span><span class="p">:</span> <span class="n">rna_ids</span><span class="p">,</span>
            <span class="s2">&quot;mature_rna_ids&quot;</span><span class="p">:</span> <span class="n">mature_rna_ids</span><span class="p">,</span>
            <span class="s2">&quot;cistron_ids&quot;</span><span class="p">:</span> <span class="n">cistron_ids</span><span class="p">,</span>
            <span class="s2">&quot;cistron_tu_mapping_matrix&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">cistron_tu_mapping_matrix</span><span class="p">,</span>
            <span class="s2">&quot;mature_rna_cistron_indexes&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">cistron_id_to_index</span><span class="p">[</span><span class="n">rna_id</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]]</span> <span class="k">for</span> <span class="n">rna_id</span> <span class="ow">in</span> <span class="n">mature_rna_ids</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="s2">&quot;all_rna_ids&quot;</span><span class="p">:</span> <span class="n">all_rna_ids</span><span class="p">,</span>
            <span class="s2">&quot;n_total_RNAs&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_rna_ids</span><span class="p">),</span>
            <span class="s2">&quot;n_avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">,</span>
            <span class="s2">&quot;cell_density&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="p">,</span>
            <span class="s2">&quot;endoRNase_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">rna_decay</span><span class="o">.</span><span class="n">endoRNase_ids</span><span class="p">,</span>
            <span class="s2">&quot;exoRNase_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">exoRNases</span><span class="p">,</span>
            <span class="s2">&quot;kcat_exoRNase&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">kcat_exoRNase</span><span class="p">,</span>
            <span class="s2">&quot;Kcat_endoRNases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">rna_decay</span><span class="o">.</span><span class="n">kcats</span><span class="p">,</span>
            <span class="s2">&quot;charged_trna_names&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">charged_trna_names</span><span class="p">,</span>
            <span class="s2">&quot;uncharged_trna_indexes&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">rna_id_to_index</span><span class="p">[</span><span class="n">trna_id</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">trna_id</span> <span class="ow">in</span> <span class="n">transcription</span><span class="o">.</span><span class="n">uncharged_trna_names</span>
                <span class="p">]</span>
            <span class="p">),</span>
            <span class="s2">&quot;rna_deg_rates&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;deg_rate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;deg_rate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="c1"># All mature RNAs are not mRNAs</span>
            <span class="s2">&quot;is_mRNA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_mRNA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;is_rRNA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_rRNA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;is_rRNA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;is_tRNA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_tRNA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;is_tRNA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="c1"># NEW to vivarium-ecoli, used to degrade duplexes from RNAi</span>
            <span class="s2">&quot;is_miscRNA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_miscRNA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;degrade_misc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">degrade_misc</span><span class="p">,</span>
            <span class="c1"># End of new code</span>
            <span class="c1"># Load lengths and nucleotide counts for all degradable RNAs</span>
            <span class="s2">&quot;rna_lengths&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(),</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(),</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;nt_counts&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;counts_ACGU&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">nt</span><span class="p">),</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;counts_ACGU&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">nt</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="c1"># Load bulk molecule names</span>
            <span class="s2">&quot;polymerized_ntp_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">polymerized_ntps</span><span class="p">,</span>
            <span class="s2">&quot;water_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">water</span><span class="p">,</span>
            <span class="s2">&quot;ppi_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppi</span><span class="p">,</span>
            <span class="s2">&quot;proton_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">proton</span><span class="p">,</span>
            <span class="s2">&quot;nmp_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">nmps</span><span class="p">,</span>
            <span class="s2">&quot;rrfa_idx&quot;</span><span class="p">:</span> <span class="n">rna_id_to_index</span><span class="p">[</span><span class="s2">&quot;RRFA-RRNA[c]&quot;</span><span class="p">],</span>
            <span class="s2">&quot;rrla_idx&quot;</span><span class="p">:</span> <span class="n">rna_id_to_index</span><span class="p">[</span><span class="s2">&quot;RRLA-RRNA[c]&quot;</span><span class="p">],</span>
            <span class="s2">&quot;rrsa_idx&quot;</span><span class="p">:</span> <span class="n">rna_id_to_index</span><span class="p">[</span><span class="s2">&quot;RRSA-RRNA[c]&quot;</span><span class="p">],</span>
            <span class="s2">&quot;ribosome30S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s30_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;ribosome50S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s50_full_complex</span><span class="p">,</span>
            <span class="c1"># Load Michaelis-Menten constants fitted to recapitulate</span>
            <span class="c1"># first-order RNA decay model</span>
            <span class="s2">&quot;Kms&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">mol</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;Km_endoRNase&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                        <span class="n">units</span><span class="o">.</span><span class="n">mol</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">L</span>
                    <span class="p">),</span>
                    <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;Km_endoRNase&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                        <span class="n">units</span><span class="o">.</span><span class="n">mol</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">L</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;RnaDegradation&quot;</span><span class="p">),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">rna_degradation_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_polypeptide_initiation_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_polypeptide_initiation_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_polypeptide_initiation_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">polypeptide_initiation_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;protein_lengths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span>
                <span class="s2">&quot;length&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(),</span>
            <span class="s2">&quot;translation_efficiencies&quot;</span><span class="p">:</span> <span class="n">normalize</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">translation_efficiencies_by_monomer</span>
            <span class="p">),</span>
            <span class="s2">&quot;active_ribosome_fraction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">ribosomeFractionActiveDict</span><span class="p">,</span>
            <span class="s2">&quot;elongation_rates&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">ribosomeElongationRateDict</span><span class="p">,</span>
            <span class="s2">&quot;variable_elongation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable_elongation_translation</span><span class="p">,</span>
            <span class="s2">&quot;make_elongation_rates&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">make_elongation_rates</span><span class="p">,</span>
            <span class="s2">&quot;rna_id_to_cistron_indexes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_id_to_cistron_indexes</span><span class="p">,</span>
            <span class="s2">&quot;cistron_start_end_pos_in_tu&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_start_end_pos_in_tu</span><span class="p">,</span>
            <span class="s2">&quot;tu_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;active_ribosome_footprint_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">active_ribosome_footprint_size</span><span class="p">,</span>
            <span class="s2">&quot;cistron_to_monomer_mapping&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">relation</span><span class="o">.</span><span class="n">cistron_to_monomer_mapping</span><span class="p">,</span>
            <span class="s2">&quot;cistron_tu_mapping_matrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_tu_mapping_matrix</span><span class="p">,</span>
            <span class="s2">&quot;monomer_index_to_cistron_index&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">i</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">_cistron_id_to_index</span><span class="p">[</span>
                    <span class="n">monomer</span><span class="p">[</span><span class="s2">&quot;cistron_id&quot;</span><span class="p">]</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">monomer</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span>
                <span class="p">)</span>
            <span class="p">},</span>
            <span class="s2">&quot;monomer_index_to_tu_indexes&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">relation</span><span class="o">.</span><span class="n">monomer_index_to_tu_indexes</span><span class="p">,</span>
            <span class="s2">&quot;ribosome30S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s30_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;ribosome50S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s50_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;PolypeptideInitiation&quot;</span><span class="p">),</span>
            <span class="s2">&quot;monomer_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">polypeptide_initiation_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_polypeptide_elongation_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_polypeptide_elongation_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_polypeptide_elongation_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">constants</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span>
        <span class="n">molecule_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span>
        <span class="n">translation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span>
        <span class="n">transcription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span>
        <span class="n">metabolism</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">metabolism</span>

        <span class="n">polypeptide_elongation_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="c1"># simulation options</span>
            <span class="s2">&quot;aa_supply_in_charging&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">aa_supply_in_charging</span><span class="p">,</span>
            <span class="s2">&quot;mechanistic_translation_supply&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_translation_supply</span><span class="p">,</span>
            <span class="s2">&quot;mechanistic_aa_transport&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_aa_transport</span><span class="p">,</span>
            <span class="s2">&quot;ppgpp_regulation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppgpp_regulation</span><span class="p">,</span>
            <span class="s2">&quot;disable_ppgpp_elongation_inhibition&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">disable_ppgpp_elongation_inhibition</span><span class="p">,</span>
            <span class="s2">&quot;variable_elongation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable_elongation_translation</span><span class="p">,</span>
            <span class="s2">&quot;translation_supply&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">translation_supply</span><span class="p">,</span>
            <span class="s2">&quot;trna_charging&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trna_charging</span><span class="p">,</span>
            <span class="c1"># base parameters</span>
            <span class="s2">&quot;n_avogadro&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">,</span>
            <span class="s2">&quot;proteinIds&quot;</span><span class="p">:</span> <span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;proteinLengths&quot;</span><span class="p">:</span> <span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(),</span>
            <span class="s2">&quot;proteinSequences&quot;</span><span class="p">:</span> <span class="n">translation</span><span class="o">.</span><span class="n">translation_sequences</span><span class="p">,</span>
            <span class="s2">&quot;aaWeightsIncorporated&quot;</span><span class="p">:</span> <span class="n">translation</span><span class="o">.</span><span class="n">translation_monomer_weights</span><span class="p">,</span>
            <span class="s2">&quot;endWeight&quot;</span><span class="p">:</span> <span class="n">translation</span><span class="o">.</span><span class="n">translation_end_weight</span><span class="p">,</span>
            <span class="s2">&quot;make_elongation_rates&quot;</span><span class="p">:</span> <span class="n">translation</span><span class="o">.</span><span class="n">make_elongation_rates</span><span class="p">,</span>
            <span class="s2">&quot;next_aa_pad&quot;</span><span class="p">:</span> <span class="n">translation</span><span class="o">.</span><span class="n">next_aa_pad</span><span class="p">,</span>
            <span class="s2">&quot;ribosomeElongationRate&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">growth_rate_parameters</span><span class="o">.</span><span class="n">ribosomeElongationRate</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                    <span class="n">units</span><span class="o">.</span><span class="n">aa</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="c1"># Amino acid supply calculations</span>
            <span class="s2">&quot;translation_aa_supply&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">translation_supply_rate</span><span class="p">,</span>
            <span class="s2">&quot;import_threshold&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">import_constraint_threshold</span><span class="p">,</span>
            <span class="c1"># Data structures for charging</span>
            <span class="s2">&quot;aa_from_trna&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">aa_from_trna</span><span class="p">,</span>
            <span class="c1"># Growth associated maintenance energy requirements for elongations</span>
            <span class="s2">&quot;gtpPerElongation&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">gtp_per_translation</span><span class="p">,</span>
            <span class="c1"># Bulk molecules</span>
            <span class="s2">&quot;ribosome30S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s30_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;ribosome50S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s50_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;amino_acids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">amino_acids</span><span class="p">,</span>
            <span class="c1"># parameters for specific elongation models</span>
            <span class="s2">&quot;aa_exchange_names&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">env_to_exchange_map</span><span class="p">[</span><span class="n">aa</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]]</span>
                    <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">amino_acids</span>
                <span class="p">]</span>
            <span class="p">),</span>
            <span class="s2">&quot;basal_elongation_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">ribosome_elongation_rate_basal</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="n">units</span><span class="o">.</span><span class="n">aa</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span>
            <span class="p">),</span>
            <span class="s2">&quot;ribosomeElongationRateDict&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">ribosomeElongationRateDict</span><span class="p">,</span>
            <span class="s2">&quot;uncharged_trna_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">uncharged_trna_names</span><span class="p">,</span>
            <span class="s2">&quot;proton&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">proton</span><span class="p">,</span>
            <span class="s2">&quot;water&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">water</span><span class="p">,</span>
            <span class="s2">&quot;cellDensity&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="p">,</span>
            <span class="s2">&quot;elongation_max&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">constants</span><span class="o">.</span><span class="n">ribosome_elongation_rate_max</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable_elongation_translation</span>
                <span class="k">else</span> <span class="n">constants</span><span class="o">.</span><span class="n">ribosome_elongation_rate_basal</span>
            <span class="p">),</span>
            <span class="s2">&quot;aa_from_synthetase&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">aa_from_synthetase</span><span class="p">,</span>
            <span class="s2">&quot;charging_stoich_matrix&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">charging_stoich_matrix</span><span class="p">(),</span>
            <span class="s2">&quot;charged_trna_names&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">charged_trna_names</span><span class="p">,</span>
            <span class="s2">&quot;charging_molecule_names&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">charging_molecules</span><span class="p">,</span>
            <span class="s2">&quot;synthetase_names&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">synthetase_names</span><span class="p">,</span>
            <span class="s2">&quot;ppgpp_reaction_metabolites&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">ppgpp_reaction_metabolites</span><span class="p">,</span>
            <span class="s2">&quot;elong_rate_by_ppgpp&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">growth_rate_parameters</span><span class="o">.</span><span class="n">get_ribosome_elongation_rate_by_ppgpp</span><span class="p">,</span>
            <span class="s2">&quot;rela&quot;</span><span class="p">:</span> <span class="n">molecule_ids</span><span class="o">.</span><span class="n">RelA</span><span class="p">,</span>
            <span class="s2">&quot;spot&quot;</span><span class="p">:</span> <span class="n">molecule_ids</span><span class="o">.</span><span class="n">SpoT</span><span class="p">,</span>
            <span class="s2">&quot;ppgpp&quot;</span><span class="p">:</span> <span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppGpp</span><span class="p">,</span>
            <span class="s2">&quot;kS&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">synthetase_charging_rate</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="s2">&quot;KMaa&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">aa_kms</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">MICROMOLAR_UNITS</span><span class="p">),</span>
            <span class="s2">&quot;KMtf&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">trna_kms</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">MICROMOLAR_UNITS</span><span class="p">),</span>
            <span class="s2">&quot;krta&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">Kdissociation_charged_trna_ribosome</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="n">MICROMOLAR_UNITS</span>
            <span class="p">),</span>
            <span class="s2">&quot;krtf&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">Kdissociation_uncharged_trna_ribosome</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="n">MICROMOLAR_UNITS</span>
            <span class="p">),</span>
            <span class="s2">&quot;unit_conversion&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">get_amino_acid_conc_conversion</span><span class="p">(</span>
                <span class="n">MICROMOLAR_UNITS</span>
            <span class="p">),</span>
            <span class="s2">&quot;KD_RelA&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">KD_RelA</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">MICROMOLAR_UNITS</span><span class="p">),</span>
            <span class="s2">&quot;k_RelA&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">k_RelA_ppGpp_synthesis</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="s2">&quot;k_SpoT_syn&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">k_SpoT_ppGpp_synthesis</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="s2">&quot;k_SpoT_deg&quot;</span><span class="p">:</span> <span class="n">constants</span><span class="o">.</span><span class="n">k_SpoT_ppGpp_degradation</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">MICROMOLAR_UNITS</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
            <span class="p">),</span>
            <span class="s2">&quot;KI_SpoT&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">KI_SpoT</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">MICROMOLAR_UNITS</span><span class="p">),</span>
            <span class="s2">&quot;ppgpp_reaction_stoich&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">ppgpp_reaction_stoich</span><span class="p">,</span>
            <span class="s2">&quot;synthesis_index&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">ppgpp_reaction_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="n">metabolism</span><span class="o">.</span><span class="n">ppgpp_synthesis_reaction</span>
            <span class="p">),</span>
            <span class="s2">&quot;degradation_index&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">ppgpp_reaction_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="n">metabolism</span><span class="o">.</span><span class="n">ppgpp_degradation_reaction</span>
            <span class="p">),</span>
            <span class="s2">&quot;aa_supply_scaling&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">aa_supply_scaling</span><span class="p">,</span>
            <span class="s2">&quot;aa_enzymes&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">aa_enzymes</span><span class="p">,</span>
            <span class="s2">&quot;amino_acid_synthesis&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">amino_acid_synthesis</span><span class="p">,</span>
            <span class="s2">&quot;amino_acid_import&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">amino_acid_import</span><span class="p">,</span>
            <span class="s2">&quot;amino_acid_export&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">amino_acid_export</span><span class="p">,</span>
            <span class="s2">&quot;aa_importers&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">aa_importer_names</span><span class="p">,</span>
            <span class="s2">&quot;aa_exporters&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">aa_exporter_names</span><span class="p">,</span>
            <span class="s2">&quot;get_pathway_enzyme_counts_per_aa&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">get_pathway_enzyme_counts_per_aa</span><span class="p">,</span>
            <span class="s2">&quot;import_constraint_threshold&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">import_constraint_threshold</span><span class="p">,</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;PolypeptideElongation&quot;</span><span class="p">),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">polypeptide_elongation_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_complexation_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_complexation_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_complexation_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">complexation_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;stoichiometry&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">stoich_matrix</span><span class="p">()</span>
            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="o">.</span><span class="n">T</span><span class="p">,</span>
            <span class="s2">&quot;rates&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">rates</span><span class="p">,</span>
            <span class="s2">&quot;molecule_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;Complexation&quot;</span><span class="p">),</span>
            <span class="s2">&quot;reaction_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">ids_reactions</span><span class="p">,</span>
            <span class="s2">&quot;complex_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">ids_complexes</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">complexation_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_two_component_system_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_two_component_system_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_two_component_system_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">two_component_system_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;jit&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="c1"># TODO -- wcEcoli has this in 1/mmol, why?</span>
            <span class="s2">&quot;n_avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">mmol</span><span class="p">),</span>
            <span class="s2">&quot;cell_density&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="n">units</span><span class="o">.</span><span class="n">g</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">L</span>
            <span class="p">),</span>
            <span class="s2">&quot;moleculesToNextTimeStep&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">two_component_system</span><span class="o">.</span><span class="n">molecules_to_next_time_step</span><span class="p">,</span>
            <span class="s2">&quot;moleculeNames&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">two_component_system</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;TwoComponentSystem&quot;</span><span class="p">),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># return two_component_system_config, stoichI, stoichJ, stoichV</span>
        <span class="k">return</span> <span class="n">two_component_system_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_equilibrium_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_equilibrium_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_equilibrium_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">equilibrium_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;jit&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;n_avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">mol</span><span class="p">),</span>
            <span class="s2">&quot;cell_density&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="n">units</span><span class="o">.</span><span class="n">g</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">L</span>
            <span class="p">),</span>
            <span class="s2">&quot;stoichMatrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">stoich_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">int64</span>
            <span class="p">),</span>
            <span class="s2">&quot;fluxesAndMoleculesToSS&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">fluxes_and_molecules_to_SS</span><span class="p">,</span>
            <span class="s2">&quot;moleculeNames&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;Equilibrium&quot;</span><span class="p">),</span>
            <span class="s2">&quot;complex_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">ids_complexes</span><span class="p">,</span>
            <span class="s2">&quot;reaction_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">rxn_ids</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">equilibrium_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_protein_degradation_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_protein_degradation_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_protein_degradation_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">protein_degradation_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;raw_degradation_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span>
                <span class="s2">&quot;deg_rate&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="s2">&quot;water_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">water</span><span class="p">,</span>
            <span class="s2">&quot;amino_acid_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">amino_acids</span><span class="p">,</span>
            <span class="s2">&quot;amino_acid_counts&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span>
                <span class="s2">&quot;aa_counts&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(),</span>
            <span class="s2">&quot;protein_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;protein_lengths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span>
                <span class="s2">&quot;length&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(),</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;ProteinDegradation&quot;</span><span class="p">),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">protein_degradation_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_metabolism_redux_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_metabolism_redux_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metabolism_redux_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">metabolism</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">metabolism</span>
        <span class="n">aa_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">amino_acids</span>
        <span class="n">aa_exchange_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">env_to_exchange_map</span><span class="p">[</span><span class="n">aa</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">aa_names</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">aa_targets_not_updated</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;L-SELENOCYSTEINE[c]&quot;</span><span class="p">}</span>

        <span class="c1"># Setup for variant that has a fixed change in ppGpp until a concentration is reached</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span> <span class="s2">&quot;ppgpp_ramp&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">ppgpp_ramp</span><span class="o">.</span><span class="n">set_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_duration</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">growth_rate_parameters</span><span class="o">.</span><span class="n">get_ppGpp_conc</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">ppgpp_ramp</span><span class="o">.</span><span class="n">get_ppGpp_conc</span>
            <span class="p">)</span>

        <span class="c1"># if current_timeline_id is specified by a variant in sim_data, look it up in saved_timelines.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_timelines</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">media_timeline</span>
        <span class="n">saved_media</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_media</span>
        <span class="n">current_concentrations</span> <span class="o">=</span> <span class="n">saved_media</span><span class="p">[</span><span class="n">current_timeline</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>

        <span class="c1"># Get import molecules</span>
        <span class="n">exch_from_conc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">exchange_data_from_concentrations</span>
        <span class="n">exchange_data</span> <span class="o">=</span> <span class="n">exch_from_conc</span><span class="p">(</span><span class="n">current_concentrations</span><span class="p">)</span>
        <span class="n">unconstrained</span> <span class="o">=</span> <span class="n">exchange_data</span><span class="p">[</span><span class="s2">&quot;importUnconstrainedExchangeMolecules&quot;</span><span class="p">]</span>
        <span class="n">constrained</span> <span class="o">=</span> <span class="n">exchange_data</span><span class="p">[</span><span class="s2">&quot;importConstrainedExchangeMolecules&quot;</span><span class="p">]</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">unconstrained</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">constrained</span><span class="p">)</span>

        <span class="n">metabolism_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="c1"># stoich</span>
            <span class="s2">&quot;stoich_dict&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">reaction_stoich</span><span class="p">,</span>
            <span class="s2">&quot;maintenance_reaction&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">maintenance_reaction</span><span class="p">,</span>
            <span class="s2">&quot;reaction_catalysts&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">reaction_catalysts</span><span class="p">,</span>
            <span class="s2">&quot;get_mass&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">getter</span><span class="o">.</span><span class="n">get_mass</span><span class="p">,</span>
            <span class="c1"># wcEcoli parameters</span>
            <span class="s2">&quot;get_import_constraints&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">get_import_constraints</span><span class="p">,</span>
            <span class="s2">&quot;aa_targets_not_updated&quot;</span><span class="p">:</span> <span class="n">aa_targets_not_updated</span><span class="p">,</span>
            <span class="s2">&quot;import_constraint_threshold&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">import_constraint_threshold</span><span class="p">,</span>
            <span class="s2">&quot;exchange_molecules&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">all_external_exchange_molecules</span><span class="p">,</span>
            <span class="c1"># these are options given to the wholecell.sim.simulation</span>
            <span class="s2">&quot;use_trna_charging&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trna_charging</span><span class="p">,</span>
            <span class="s2">&quot;include_ppgpp&quot;</span><span class="p">:</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppgpp_regulation</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trna_charging</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">metabolism</span><span class="p">,</span> <span class="s2">&quot;force_constant_ppgpp&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;mechanistic_aa_transport&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_aa_transport</span><span class="p">,</span>
            <span class="c1"># variables</span>
            <span class="s2">&quot;avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">,</span>
            <span class="s2">&quot;cell_density&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="p">,</span>
            <span class="s2">&quot;nutrient_to_doubling_time&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">nutrient_to_doubling_time</span><span class="p">,</span>
            <span class="s2">&quot;dark_atp&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">darkATP</span><span class="p">,</span>
            <span class="s2">&quot;non_growth_associated_maintenance&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">non_growth_associated_maintenance</span><span class="p">,</span>
            <span class="s2">&quot;cell_dry_mass_fraction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">cell_dry_mass_fraction</span><span class="p">,</span>
            <span class="s2">&quot;ppgpp_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppGpp</span><span class="p">,</span>
            <span class="s2">&quot;get_ppGpp_conc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">growth_rate_parameters</span><span class="o">.</span><span class="n">get_ppGpp_conc</span><span class="p">,</span>
            <span class="s2">&quot;get_masses&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">getter</span><span class="o">.</span><span class="n">get_masses</span><span class="p">,</span>
            <span class="s2">&quot;kinetic_constraint_reactions&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">kinetic_constraint_reactions</span><span class="p">,</span>
            <span class="s2">&quot;doubling_time&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition_to_doubling_time</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition</span>
            <span class="p">],</span>
            <span class="s2">&quot;get_biomass_as_concentrations&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">getBiomassAsConcentrations</span><span class="p">,</span>
            <span class="s2">&quot;aa_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">amino_acids</span><span class="p">,</span>
            <span class="s2">&quot;linked_metabolites&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">concentration_updates</span><span class="o">.</span><span class="n">linked_metabolites</span><span class="p">,</span>
            <span class="s2">&quot;aa_exchange_names&quot;</span><span class="p">:</span> <span class="n">aa_exchange_names</span><span class="p">,</span>
            <span class="s2">&quot;removed_aa_uptake&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">aa</span> <span class="ow">in</span> <span class="n">aa_targets_not_updated</span> <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">aa_exchange_names</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="s2">&quot;constraints_to_disable&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">constraints_to_disable</span><span class="p">,</span>
            <span class="s2">&quot;secretion_penalty_coeff&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">secretion_penalty_coeff</span><span class="p">,</span>
            <span class="s2">&quot;kinetic_objective_weight&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">kinetic_objective_weight</span><span class="p">,</span>
            <span class="s2">&quot;kinetic_objective_weight_in_range&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">kinetic_objective_weight_in_range</span><span class="p">,</span>
            <span class="c1"># these values came from the initialized environment state</span>
            <span class="s2">&quot;current_timeline&quot;</span><span class="p">:</span> <span class="n">current_timeline</span><span class="p">,</span>
            <span class="s2">&quot;media_id&quot;</span><span class="p">:</span> <span class="n">current_timeline</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;imports&quot;</span><span class="p">:</span> <span class="n">imports</span><span class="p">,</span>
            <span class="c1"># methods</span>
            <span class="s2">&quot;concentration_updates&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">concentration_updates</span><span class="p">,</span>
            <span class="s2">&quot;exchange_data_from_media&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">exchange_data_from_media</span><span class="p">,</span>
            <span class="s2">&quot;get_kinetic_constraints&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">get_kinetic_constraints</span><span class="p">,</span>
            <span class="s2">&quot;exchange_constraints&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">exchange_constraints</span><span class="p">,</span>
            <span class="c1"># ports schema</span>
            <span class="s2">&quot;catalyst_ids&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">catalyst_ids</span><span class="p">,</span>
            <span class="s2">&quot;kinetic_constraint_enzymes&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">kinetic_constraint_enzymes</span><span class="p">,</span>
            <span class="s2">&quot;kinetic_constraint_substrates&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">kinetic_constraint_substrates</span><span class="p">,</span>
            <span class="c1"># Used to create conversion matrix that compiles individual fluxes</span>
            <span class="c1"># in the FBA solution to the fluxes of base reactions</span>
            <span class="s2">&quot;base_reaction_ids&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">base_reaction_ids</span><span class="p">,</span>
            <span class="s2">&quot;fba_reaction_ids_to_base_reaction_ids&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">reaction_id_to_base_reaction_id</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># TODO Create new config-get with only necessary parts.</span>

        <span class="k">return</span> <span class="n">metabolism_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_metabolism_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_metabolism_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metabolism_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># bad_rxns = [&quot;RXN-12440&quot;, &quot;TRANS-RXN-121&quot;, &quot;TRANS-RXN-300&quot;]</span>
        <span class="c1"># for rxn in bad_rxns:</span>
        <span class="c1">#     self.sim_data.process.metabolism.reaction_stoich.pop(rxn, None)</span>
        <span class="c1">#     self.sim_data.process.metabolism.reaction_catalysts.pop(rxn, None)</span>
        <span class="c1">#     self.sim_data.process.metabolism.reactions_with_catalyst.remove(rxn) \</span>
        <span class="c1">#         if rxn in self.sim_data.process.metabolism.reactions_with_catalyst else None</span>
        <span class="n">metabolism</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">metabolism</span>
        <span class="n">aa_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">amino_acids</span>
        <span class="n">aa_exchange_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">env_to_exchange_map</span><span class="p">[</span><span class="n">aa</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">aa_names</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">aa_targets_not_updated</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;L-SELENOCYSTEINE[c]&quot;</span><span class="p">}</span>

        <span class="c1"># Setup for variant that has a fixed change in ppGpp until a concentration is reached</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span> <span class="s2">&quot;ppgpp_ramp&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">ppgpp_ramp</span><span class="o">.</span><span class="n">set_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_duration</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">growth_rate_parameters</span><span class="o">.</span><span class="n">get_ppGpp_conc</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">ppgpp_ramp</span><span class="o">.</span><span class="n">get_ppGpp_conc</span>
            <span class="p">)</span>

        <span class="c1"># if current_timeline_id is specified by a variant in sim_data, look it up in saved_timelines.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_timelines</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">media_timeline</span>
        <span class="n">saved_media</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_media</span>
        <span class="n">current_concentrations</span> <span class="o">=</span> <span class="n">saved_media</span><span class="p">[</span><span class="n">current_timeline</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>

        <span class="c1"># Get import molecules</span>
        <span class="n">exch_from_conc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">exchange_data_from_concentrations</span>
        <span class="n">exchange_data</span> <span class="o">=</span> <span class="n">exch_from_conc</span><span class="p">(</span><span class="n">current_concentrations</span><span class="p">)</span>
        <span class="n">unconstrained</span> <span class="o">=</span> <span class="n">exchange_data</span><span class="p">[</span><span class="s2">&quot;importUnconstrainedExchangeMolecules&quot;</span><span class="p">]</span>
        <span class="n">constrained</span> <span class="o">=</span> <span class="n">exchange_data</span><span class="p">[</span><span class="s2">&quot;importConstrainedExchangeMolecules&quot;</span><span class="p">]</span>
        <span class="n">imports</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">unconstrained</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">constrained</span><span class="p">)</span>

        <span class="n">metabolism_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="c1"># metabolism parameters</span>
            <span class="s2">&quot;stoichiometry&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">reaction_stoich</span><span class="p">,</span>
            <span class="s2">&quot;catalyst_ids&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">catalyst_ids</span><span class="p">,</span>
            <span class="s2">&quot;concentration_updates&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">concentration_updates</span><span class="p">,</span>
            <span class="s2">&quot;maintenance_reaction&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">maintenance_reaction</span><span class="p">,</span>
            <span class="c1"># wcEcoli parameters</span>
            <span class="s2">&quot;get_import_constraints&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">get_import_constraints</span><span class="p">,</span>
            <span class="s2">&quot;nutrientToDoublingTime&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">nutrient_to_doubling_time</span><span class="p">,</span>
            <span class="s2">&quot;aa_names&quot;</span><span class="p">:</span> <span class="n">aa_names</span><span class="p">,</span>
            <span class="s2">&quot;aa_targets_not_updated&quot;</span><span class="p">:</span> <span class="n">aa_targets_not_updated</span><span class="p">,</span>
            <span class="s2">&quot;import_constraint_threshold&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">import_constraint_threshold</span><span class="p">,</span>
            <span class="s2">&quot;exchange_molecules&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">all_external_exchange_molecules</span><span class="p">,</span>
            <span class="c1"># these are options given to the wholecell.sim.simulation</span>
            <span class="s2">&quot;use_trna_charging&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trna_charging</span><span class="p">,</span>
            <span class="s2">&quot;include_ppgpp&quot;</span><span class="p">:</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppgpp_regulation</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trna_charging</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">metabolism</span><span class="p">,</span> <span class="s2">&quot;force_constant_ppgpp&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
            <span class="s2">&quot;mechanistic_aa_transport&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_aa_transport</span><span class="p">,</span>
            <span class="c1"># these values came from the initialized environment state</span>
            <span class="s2">&quot;current_timeline&quot;</span><span class="p">:</span> <span class="n">current_timeline</span><span class="p">,</span>
            <span class="s2">&quot;media_id&quot;</span><span class="p">:</span> <span class="n">current_timeline</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;imports&quot;</span><span class="p">:</span> <span class="n">imports</span><span class="p">,</span>
            <span class="s2">&quot;metabolism&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="p">,</span>
            <span class="s2">&quot;ngam&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">non_growth_associated_maintenance</span><span class="p">,</span>
            <span class="s2">&quot;avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">,</span>
            <span class="s2">&quot;cell_density&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="p">,</span>
            <span class="s2">&quot;dark_atp&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">darkATP</span><span class="p">,</span>
            <span class="s2">&quot;cell_dry_mass_fraction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">cell_dry_mass_fraction</span><span class="p">,</span>
            <span class="s2">&quot;get_biomass_as_concentrations&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">getBiomassAsConcentrations</span><span class="p">,</span>
            <span class="s2">&quot;ppgpp_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppGpp</span><span class="p">,</span>
            <span class="s2">&quot;get_ppGpp_conc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">growth_rate_parameters</span><span class="o">.</span><span class="n">get_ppGpp_conc</span><span class="p">,</span>
            <span class="s2">&quot;exchange_data_from_media&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">exchange_data_from_media</span><span class="p">,</span>
            <span class="s2">&quot;get_masses&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">getter</span><span class="o">.</span><span class="n">get_masses</span><span class="p">,</span>
            <span class="s2">&quot;doubling_time&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition_to_doubling_time</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition</span>
            <span class="p">],</span>
            <span class="s2">&quot;amino_acid_ids&quot;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">amino_acid_code_to_id_ordered</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">),</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;Metabolism&quot;</span><span class="p">),</span>
            <span class="s2">&quot;linked_metabolites&quot;</span><span class="p">:</span> <span class="n">metabolism</span><span class="o">.</span><span class="n">concentration_updates</span><span class="o">.</span><span class="n">linked_metabolites</span><span class="p">,</span>
            <span class="s2">&quot;aa_exchange_names&quot;</span><span class="p">:</span> <span class="n">aa_exchange_names</span><span class="p">,</span>
            <span class="s2">&quot;removed_aa_uptake&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">aa</span> <span class="ow">in</span> <span class="n">aa_targets_not_updated</span> <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">aa_exchange_names</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="c1"># TODO: testing, remove later (perhaps after moving change to sim_data)</span>
            <span class="s2">&quot;reduce_murein_objective&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="c1"># Used to create conversion matrix that compiles individual fluxes</span>
            <span class="c1"># in the FBA solution to the fluxes of base reactions</span>
            <span class="s2">&quot;base_reaction_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">metabolism</span><span class="o">.</span><span class="n">base_reaction_ids</span><span class="p">,</span>
            <span class="s2">&quot;fba_reaction_ids_to_base_reaction_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">metabolism</span><span class="o">.</span><span class="n">reaction_id_to_base_reaction_id</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">metabolism_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_mass_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_mass_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_mass_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">bulk_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">molecular_weights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">molecule_id</span> <span class="ow">in</span> <span class="n">bulk_ids</span><span class="p">:</span>
            <span class="n">molecular_weights</span><span class="p">[</span><span class="n">molecule_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">getter</span><span class="o">.</span><span class="n">get_mass</span><span class="p">(</span>
                <span class="n">molecule_id</span>
            <span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">fg</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>

        <span class="c1"># unique molecule masses</span>
        <span class="n">unique_masses</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">uniqueMoleculeMasses</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">unique_molecule</span><span class="o">.</span><span class="n">unique_molecule_masses</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">mass</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">uniqueMoleculeMasses</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">uniqueMoleculeMasses</span><span class="p">[</span><span class="s2">&quot;mass&quot;</span><span class="p">]):</span>
            <span class="n">unique_masses</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">mass</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="n">units</span><span class="o">.</span><span class="n">fg</span>
            <span class="p">)</span>

        <span class="n">mass_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;molecular_weights&quot;</span><span class="p">:</span> <span class="n">molecular_weights</span><span class="p">,</span>
            <span class="s2">&quot;unique_masses&quot;</span><span class="p">:</span> <span class="n">unique_masses</span><span class="p">,</span>
            <span class="s2">&quot;cellDensity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="n">units</span><span class="o">.</span><span class="n">g</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">L</span>
            <span class="p">),</span>
            <span class="s2">&quot;water_id&quot;</span><span class="p">:</span> <span class="s2">&quot;WATER[c]&quot;</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">mass_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_mass_listener_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_mass_listener_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_mass_listener_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">u_masses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">unique_molecule</span><span class="o">.</span><span class="n">unique_molecule_masses</span>
        <span class="n">molecule_ids</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">u_masses</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]))</span>
        <span class="n">molecule_id_to_mass</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">mass</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">u_masses</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">u_masses</span><span class="p">[</span><span class="s2">&quot;mass&quot;</span><span class="p">]):</span>
            <span class="n">molecule_id_to_mass</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">mass</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span>
            <span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">fg</span><span class="p">)</span>
        <span class="n">molecule_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">molecule_id_to_mass</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">molecule_ids</span><span class="p">])</span>

        <span class="n">mass_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;cellDensity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">cell_density</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span>
                <span class="n">units</span><span class="o">.</span><span class="n">g</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">L</span>
            <span class="p">),</span>
            <span class="s2">&quot;bulk_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;bulk_masses&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span>
                <span class="s2">&quot;mass&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">fg</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">mol</span><span class="p">)</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">mol</span><span class="p">),</span>
            <span class="s2">&quot;unique_ids&quot;</span><span class="p">:</span> <span class="n">molecule_ids</span><span class="p">,</span>
            <span class="s2">&quot;unique_masses&quot;</span><span class="p">:</span> <span class="n">molecule_masses</span><span class="p">,</span>
            <span class="s2">&quot;compartment_abbrev_to_index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_abbrev_to_index</span><span class="p">,</span>
            <span class="s2">&quot;expectedDryMassIncreaseDict&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">expectedDryMassIncreaseDict</span><span class="p">,</span>
            <span class="s2">&quot;compartment_indices&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span>
                    <span class="s2">&quot;CCO-CELL-PROJECTION&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;cytosol&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span><span class="s2">&quot;CCO-CYTOSOL&quot;</span><span class="p">],</span>
                <span class="s2">&quot;extracellular&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span>
                    <span class="s2">&quot;CCO-EXTRACELLULAR&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;flagellum&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span><span class="s2">&quot;CCO-FLAGELLUM&quot;</span><span class="p">],</span>
                <span class="s2">&quot;membrane&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span><span class="s2">&quot;CCO-MEMBRANE&quot;</span><span class="p">],</span>
                <span class="s2">&quot;outer_membrane&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span>
                    <span class="s2">&quot;CCO-OUTER-MEM&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;periplasm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span><span class="s2">&quot;CCO-PERI-BAC&quot;</span><span class="p">],</span>
                <span class="s2">&quot;pilus&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span><span class="s2">&quot;CCO-PILUS&quot;</span><span class="p">],</span>
                <span class="s2">&quot;inner_membrane&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">[</span>
                    <span class="s2">&quot;CCO-PM-BAC-NEG&quot;</span>
                <span class="p">],</span>
            <span class="p">},</span>
            <span class="s2">&quot;compartment_id_to_index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">compartment_id_to_index</span><span class="p">,</span>
            <span class="s2">&quot;n_avogadro&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span><span class="p">,</span>  <span class="c1"># 1/mol</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;submass_to_idx&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">submass_name_to_index</span><span class="p">,</span>
            <span class="s2">&quot;condition_to_doubling_time&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition_to_doubling_time</span><span class="p">,</span>
            <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">condition</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">mass_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_rna_counts_listener_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_rna_counts_listener_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rna_counts_listener_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">counts_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;all_TU_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;mRNA_indexes&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_mRNA&quot;</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;rRNA_indexes&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_rRNA&quot;</span><span class="p">]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;all_cistron_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;cistron_is_mRNA&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span>
                <span class="s2">&quot;is_mRNA&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;cistron_is_rRNA&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span>
                <span class="s2">&quot;is_rRNA&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;cistron_tu_mapping_matrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_tu_mapping_matrix</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;mRNA_TU_ids&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;all_TU_ids&quot;</span><span class="p">][</span>
            <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;mRNA_indexes&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;rRNA_TU_ids&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;all_TU_ids&quot;</span><span class="p">][</span>
            <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;rRNA_indexes&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;mRNA_cistron_ids&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;all_cistron_ids&quot;</span><span class="p">][</span>
            <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;cistron_is_mRNA&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;rRNA_cistron_ids&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;all_cistron_ids&quot;</span><span class="p">][</span>
            <span class="n">counts_config</span><span class="p">[</span><span class="s2">&quot;cistron_is_rRNA&quot;</span><span class="p">]</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">counts_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_monomer_counts_listener_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_monomer_counts_listener_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_monomer_counts_listener_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">monomer_counts_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="c1"># Get IDs of all bulk molecules</span>
            <span class="s2">&quot;bulk_molecule_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span>
                <span class="s2">&quot;id&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;unique_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">unique_molecule</span><span class="o">.</span><span class="n">unique_molecule_masses</span><span class="p">[</span>
                <span class="s2">&quot;id&quot;</span>
            <span class="p">],</span>
            <span class="c1"># Get IDs of molecules involved in complexation and equilibrium</span>
            <span class="s2">&quot;complexation_molecule_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
            <span class="s2">&quot;complexation_complex_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">ids_complexes</span><span class="p">,</span>
            <span class="s2">&quot;equilibrium_molecule_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">molecule_names</span><span class="p">,</span>
            <span class="s2">&quot;equilibrium_complex_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">ids_complexes</span><span class="p">,</span>
            <span class="s2">&quot;monomer_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span>
                <span class="s2">&quot;id&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="c1"># Get IDs of complexed molecules monomers involved in two component system</span>
            <span class="s2">&quot;two_component_system_molecule_ids&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">two_component_system</span><span class="o">.</span><span class="n">molecule_names</span>
            <span class="p">),</span>
            <span class="s2">&quot;two_component_system_complex_ids&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">two_component_system</span><span class="o">.</span><span class="n">complex_to_monomer</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">),</span>
            <span class="c1"># Get IDs of ribosome subunits</span>
            <span class="s2">&quot;ribosome_50s_subunits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">get_monomers</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s50_full_complex</span>
            <span class="p">),</span>
            <span class="s2">&quot;ribosome_30s_subunits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">get_monomers</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s30_full_complex</span>
            <span class="p">),</span>
            <span class="c1"># Get IDs of RNA polymerase subunits</span>
            <span class="s2">&quot;rnap_subunits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">get_monomers</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">full_RNAP</span>
            <span class="p">),</span>
            <span class="c1"># Get IDs of replisome subunits</span>
            <span class="s2">&quot;replisome_trimer_subunits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">replisome_trimer_subunits</span><span class="p">,</span>
            <span class="s2">&quot;replisome_monomer_subunits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">replisome_monomer_subunits</span><span class="p">,</span>
            <span class="c1"># Get stoichiometric matrices for complexation, equilibrium, two component system and the</span>
            <span class="c1"># assembly of unique molecules</span>
            <span class="s2">&quot;complexation_stoich&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">complexation</span><span class="o">.</span><span class="n">stoich_matrix_monomers</span><span class="p">(),</span>
            <span class="s2">&quot;equilibrium_stoich&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">equilibrium</span><span class="o">.</span><span class="n">stoich_matrix_monomers</span><span class="p">(),</span>
            <span class="s2">&quot;two_component_system_stoich&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">two_component_system</span><span class="o">.</span><span class="n">stoich_matrix_monomers</span><span class="p">(),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">monomer_counts_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_allocator_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_allocator_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_allocator_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">process_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">process_names</span><span class="p">:</span>
            <span class="n">process_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">allocator_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;molecule_names&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span>
                <span class="s2">&quot;id&quot;</span>
            <span class="p">],</span>
            <span class="c1"># Allocator is built into BulkMolecules container in wcEcoli</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;BulkMolecules&quot;</span><span class="p">),</span>
            <span class="s2">&quot;process_names&quot;</span><span class="p">:</span> <span class="n">process_names</span><span class="p">,</span>
            <span class="s2">&quot;custom_priorities&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;ecoli-rna-degradation&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="s2">&quot;ecoli-protein-degradation&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="s2">&quot;ecoli-two-component-system&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
                <span class="s2">&quot;ecoli-tf-binding&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>
                <span class="s2">&quot;ecoli-metabolism&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">allocator_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_chromosome_structure_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_chromosome_structure_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_chromosome_structure_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">transcription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span>
        <span class="n">mature_rna_ids</span> <span class="o">=</span> <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">unprocessed_rna_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_unprocessed&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">chromosome_structure_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="c1"># Load parameters</span>
            <span class="s2">&quot;rna_sequences&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">transcription_sequences</span><span class="p">,</span>
            <span class="s2">&quot;protein_sequences&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">translation_sequences</span><span class="p">,</span>
            <span class="s2">&quot;n_TUs&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">),</span>
            <span class="s2">&quot;n_TFs&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">tf_ids</span><span class="p">),</span>
            <span class="s2">&quot;rna_ids&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;n_amino_acids&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">amino_acids</span><span class="p">),</span>
            <span class="s2">&quot;n_fragment_bases&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">polymerized_ntps</span><span class="p">),</span>
            <span class="s2">&quot;replichore_lengths&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">replichore_lengths</span><span class="p">,</span>
            <span class="s2">&quot;relaxed_DNA_base_pairs_per_turn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">chromosome_structure</span><span class="o">.</span><span class="n">relaxed_DNA_base_pairs_per_turn</span><span class="p">,</span>
            <span class="s2">&quot;terC_index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">chromosome_structure</span><span class="o">.</span><span class="n">terC_dummy_molecule_index</span><span class="p">,</span>
            <span class="s2">&quot;n_mature_rnas&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">mature_rna_ids</span><span class="p">),</span>
            <span class="s2">&quot;mature_rna_ids&quot;</span><span class="p">:</span> <span class="n">mature_rna_ids</span><span class="p">,</span>
            <span class="s2">&quot;mature_rna_end_positions&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_end_positions</span><span class="p">,</span>
            <span class="s2">&quot;mature_rna_nt_counts&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;counts_ACGU&quot;</span><span class="p">]</span>
            <span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">nt</span><span class="p">)</span>
            <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
            <span class="s2">&quot;unprocessed_rna_index_mapping&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">rna_index</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">rna_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unprocessed_rna_indexes</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="s2">&quot;calculate_superhelical_densities&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">superhelical_density</span><span class="p">,</span>
            <span class="c1"># Get placeholder value for chromosome domains without children</span>
            <span class="s2">&quot;no_child_place_holder&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">replication</span><span class="o">.</span><span class="n">no_child_place_holder</span><span class="p">,</span>
            <span class="c1"># Load bulk molecule views</span>
            <span class="s2">&quot;inactive_RNAPs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">full_RNAP</span><span class="p">,</span>
            <span class="s2">&quot;fragmentBases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">polymerized_ntps</span><span class="p">,</span>
            <span class="s2">&quot;ppi&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppi</span><span class="p">,</span>
            <span class="s2">&quot;active_tfs&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;[c]&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">tf_ids</span>
            <span class="p">],</span>
            <span class="s2">&quot;ribosome_30S_subunit&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s30_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;ribosome_50S_subunit&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s50_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;amino_acids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">amino_acids</span><span class="p">,</span>
            <span class="s2">&quot;water&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">water</span><span class="p">,</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seedFromName</span><span class="p">(</span><span class="s2">&quot;ChromosomeStructure&quot;</span><span class="p">),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">chromosome_structure_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_rna_interference_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_rna_interference_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rna_interference_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">rna_interference_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;srna_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">srna_ids</span><span class="p">,</span>
            <span class="s2">&quot;target_tu_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_tu_ids</span><span class="p">,</span>
            <span class="s2">&quot;binding_probs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_probs</span><span class="p">,</span>
            <span class="s2">&quot;duplex_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">duplex_ids</span><span class="p">,</span>
            <span class="s2">&quot;ribosome30S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s30_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;ribosome50S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">s50_full_complex</span><span class="p">,</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">RAND_MAX</span><span class="p">),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">rna_interference_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_tetracycline_ribosome_equilibrium_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_tetracycline_ribosome_equilibrium_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_tetracycline_ribosome_equilibrium_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">rna_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">is_trna</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_tRNA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">bool_</span>
        <span class="p">)</span>
        <span class="n">tetracycline_ribosome_equilibrium_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;trna_ids&quot;</span><span class="p">:</span> <span class="n">rna_ids</span><span class="p">[</span><span class="n">is_trna</span><span class="p">],</span>
            <span class="c1"># Ensure that a new seed is set upon division</span>
            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">RAND_MAX</span><span class="p">),</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">tetracycline_ribosome_equilibrium_config</span></div>


<div class="viewcode-block" id="LoadSimData.get_rna_maturation_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_rna_maturation_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rna_maturation_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">transcription</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span>
        <span class="n">rna_data</span> <span class="o">=</span> <span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span>
        <span class="n">mature_rna_data</span> <span class="o">=</span> <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span>

        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="c1"># Get matrices and vectors that describe maturation reactions</span>
            <span class="s2">&quot;stoich_matrix&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">rna_maturation_stoich_matrix</span><span class="p">,</span>
            <span class="s2">&quot;enzyme_matrix&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">rna_maturation_enzyme_matrix</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
            <span class="s2">&quot;degraded_nt_counts&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">rna_maturation_degraded_nt_counts</span><span class="p">,</span>
            <span class="c1"># Get rRNA IDs</span>
            <span class="s2">&quot;main_23s_rRNA_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">s50_23s_rRNA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;main_16s_rRNA_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">s30_16s_rRNA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;main_5s_rRNA_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">s50_5s_rRNA</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;variant_23s_rRNA_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">s50_23s_rRNA</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="s2">&quot;variant_16s_rRNA_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">s30_16s_rRNA</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="s2">&quot;variant_5s_rRNA_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">s50_5s_rRNA</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="s2">&quot;unprocessed_rna_ids&quot;</span><span class="p">:</span> <span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">][</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_unprocessed&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;mature_rna_ids&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;rna_maturation_enzyme_ids&quot;</span><span class="p">:</span> <span class="n">transcription</span><span class="o">.</span><span class="n">rna_maturation_enzymes</span><span class="p">,</span>
            <span class="c1"># Other bulk IDs</span>
            <span class="s2">&quot;fragment_bases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">polymerized_ntps</span><span class="p">,</span>
            <span class="s2">&quot;ppi&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">ppi</span><span class="p">,</span>
            <span class="s2">&quot;water&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">water</span><span class="p">,</span>
            <span class="s2">&quot;nmps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_groups</span><span class="o">.</span><span class="n">nmps</span><span class="p">,</span>
            <span class="s2">&quot;proton&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">molecule_ids</span><span class="o">.</span><span class="n">proton</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;n_required_enzymes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;enzyme_matrix&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;n_ppi_added&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;stoich_matrix&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1"># Calculate number of NMPs that should be added when consolidating rRNA</span>
        <span class="c1"># molecules</span>
        <span class="n">counts_ACGU</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;counts_ACGU&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">nt</span><span class="p">),</span>
                <span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;counts_ACGU&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">nt</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">rna_id_to_index</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">rna_id</span><span class="p">:</span> <span class="n">i</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rna_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">mature_rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]))</span>
        <span class="p">}</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">calculate_delta_nt_counts</span><span class="p">(</span><span class="n">main_id</span><span class="p">,</span> <span class="n">variant_ids</span><span class="p">):</span>
            <span class="n">main_index</span> <span class="o">=</span> <span class="n">rna_id_to_index</span><span class="p">[</span><span class="n">main_id</span><span class="p">]</span>
            <span class="n">variant_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">rna_id_to_index</span><span class="p">[</span><span class="n">rna_id</span><span class="p">]</span> <span class="k">for</span> <span class="n">rna_id</span> <span class="ow">in</span> <span class="n">variant_ids</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">delta_nt_counts</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">counts_ACGU</span><span class="p">[</span><span class="n">variant_indexes</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">counts_ACGU</span><span class="p">[</span><span class="n">main_index</span><span class="p">,</span> <span class="p">:]</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">delta_nt_counts</span>

        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;delta_nt_counts_23s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_delta_nt_counts</span><span class="p">(</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;main_23s_rRNA_id&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;variant_23s_rRNA_ids&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;delta_nt_counts_16s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_delta_nt_counts</span><span class="p">(</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;main_16s_rRNA_id&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;variant_16s_rRNA_ids&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;delta_nt_counts_5s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_delta_nt_counts</span><span class="p">(</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;main_5s_rRNA_id&quot;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;variant_5s_rRNA_ids&quot;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">config</span></div>


<div class="viewcode-block" id="LoadSimData.get_tf_unbinding_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_tf_unbinding_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_tf_unbinding_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;tf_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">tf_ids</span><span class="p">,</span>
            <span class="s2">&quot;submass_indices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">submass_indices</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># Build array of active TF masses</span>
        <span class="n">bulk_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">tf_indexes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">bulk_ids</span> <span class="o">==</span> <span class="n">tf_id</span> <span class="o">+</span> <span class="s2">&quot;[c]&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">tf_id</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;tf_ids&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;active_tf_masses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">bulk_molecules</span><span class="o">.</span><span class="n">bulk_data</span><span class="p">[</span><span class="s2">&quot;mass&quot;</span><span class="p">][</span><span class="n">tf_indexes</span><span class="p">]</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">n_avogadro</span>
        <span class="p">)</span><span class="o">.</span><span class="n">asNumber</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">fg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">config</span></div>


<div class="viewcode-block" id="LoadSimData.get_rna_synth_prob_listener_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_rna_synth_prob_listener_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rna_synth_prob_listener_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;gene_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;rna_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;tf_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription_regulation</span><span class="o">.</span><span class="n">tf_ids</span><span class="p">,</span>
            <span class="s2">&quot;cistron_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;gene_id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;cistron_tu_mapping_matrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_tu_mapping_matrix</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="LoadSimData.get_dna_supercoiling_listener_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_dna_supercoiling_listener_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_dna_supercoiling_listener_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;relaxed_DNA_base_pairs_per_turn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">chromosome_structure</span><span class="o">.</span><span class="n">relaxed_DNA_base_pairs_per_turn</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="LoadSimData.get_unique_molecule_counts_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_unique_molecule_counts_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_unique_molecule_counts_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;unique_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">internal_state</span><span class="o">.</span><span class="n">unique_molecule</span><span class="o">.</span><span class="n">unique_molecule_masses</span><span class="p">[</span>
                <span class="s2">&quot;id&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="LoadSimData.get_ribosome_data_listener_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_ribosome_data_listener_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ribosome_data_listener_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;monomer_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">translation</span><span class="o">.</span><span class="n">monomer_data</span><span class="p">[</span>
                <span class="s2">&quot;id&quot;</span>
            <span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;rRNA_cistron_tu_mapping_matrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rRNA_cistron_tu_mapping_matrix</span><span class="p">,</span>
            <span class="s2">&quot;rRNA_is_5S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span>
                <span class="s2">&quot;is_5S_rRNA&quot;</span>
            <span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;is_rRNA&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;rRNA_is_16S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span>
                <span class="s2">&quot;is_16S_rRNA&quot;</span>
            <span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;is_rRNA&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;rRNA_is_23S&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span>
                <span class="s2">&quot;is_23S_rRNA&quot;</span>
            <span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;is_rRNA&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="LoadSimData.get_rnap_data_listener_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_rnap_data_listener_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rnap_data_listener_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;stable_RNA_indexes&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_rRNA&quot;</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">rna_data</span><span class="p">[</span><span class="s2">&quot;is_tRNA&quot;</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;cistron_ids&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_data</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="s2">&quot;cistron_tu_mapping_matrix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">cistron_tu_mapping_matrix</span><span class="p">,</span>
            <span class="s2">&quot;emit_unique&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">emit_unique</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="LoadSimData.get_exchange_data_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_exchange_data_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_exchange_data_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;external_state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="p">,</span>
            <span class="s2">&quot;environment_molecules&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">env_to_exchange_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">),</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="LoadSimData.get_media_update_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_media_update_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_media_update_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># if current_timeline_id is specified by a variant in sim_data,</span>
        <span class="c1"># look it up in saved_timelines.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_timelines</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">media_timeline</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;saved_media&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_media</span><span class="p">,</span>
            <span class="s2">&quot;media_id&quot;</span><span class="p">:</span> <span class="n">current_timeline</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="LoadSimData.get_bulk_timeline_config">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.get_bulk_timeline_config">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_bulk_timeline_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># if current_timeline_id is specified by a variant in sim_data, look it up in saved_timelines.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_timelines</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">media_timeline</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;time_step&quot;</span><span class="p">:</span> <span class="n">time_step</span><span class="p">,</span>
            <span class="s2">&quot;timeline&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">time</span><span class="p">:</span> <span class="p">{(</span><span class="s2">&quot;media_id&quot;</span><span class="p">,):</span> <span class="n">media_id</span><span class="p">}</span> <span class="k">for</span> <span class="n">time</span><span class="p">,</span> <span class="n">media_id</span> <span class="ow">in</span> <span class="n">current_timeline</span>
            <span class="p">},</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="LoadSimData.generate_initial_state">
<a class="viewcode-back" href="../../../reference/api/ecoli/ecoli.library.sim_data.html#ecoli.library.sim_data.LoadSimData.generate_initial_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_initial_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the initial conditions for a new cell without inherited state</span>
<span class="sd">        from a parent cell.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mass_coeff</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_state_gaussian</span><span class="p">:</span>
            <span class="n">mass_coeff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="c1"># if current_timeline_id is specified by a variant in sim_data,</span>
        <span class="c1"># look it up in saved_timelines.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_timelines</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">current_timeline_id</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_timeline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">media_timeline</span>
        <span class="n">media_id</span> <span class="o">=</span> <span class="n">current_timeline</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">current_concentrations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">saved_media</span><span class="p">[</span><span class="n">media_id</span><span class="p">]</span>
        <span class="n">exch_from_conc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">.</span><span class="n">external_state</span><span class="o">.</span><span class="n">exchange_data_from_concentrations</span>
        <span class="n">exchange_data</span> <span class="o">=</span> <span class="n">exch_from_conc</span><span class="p">(</span><span class="n">current_concentrations</span><span class="p">)</span>
        <span class="n">unconstrained</span> <span class="o">=</span> <span class="n">exchange_data</span><span class="p">[</span><span class="s2">&quot;importUnconstrainedExchangeMolecules&quot;</span><span class="p">]</span>
        <span class="n">constrained</span> <span class="o">=</span> <span class="n">exchange_data</span><span class="p">[</span><span class="s2">&quot;importConstrainedExchangeMolecules&quot;</span><span class="p">]</span>
        <span class="n">import_molecules</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">unconstrained</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">constrained</span><span class="p">)</span>

        <span class="n">bulk_state</span> <span class="o">=</span> <span class="n">initialize_bulk_counts</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span>
            <span class="n">media_id</span><span class="p">,</span>
            <span class="n">import_molecules</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">mass_coeff</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ppgpp_regulation</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trna_attenuation</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cell_mass</span> <span class="o">=</span> <span class="n">calculate_cell_mass</span><span class="p">(</span><span class="n">bulk_state</span><span class="p">,</span> <span class="p">{},</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">)</span>
        <span class="c1"># Create new PRNG for unique ID generation so self.random_state</span>
        <span class="c1"># can be used to faithfully replicate wcEcoli behavior</span>
        <span class="n">unique_id_rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">unique_molecules</span> <span class="o">=</span> <span class="n">initialize_unique_molecules</span><span class="p">(</span>
            <span class="n">bulk_state</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span>
            <span class="n">cell_mass</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">unique_id_rng</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">superhelical_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ppgpp_regulation</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trna_attenuation</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mechanistic_replisome</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trna_charging</span><span class="p">:</span>
            <span class="n">initialize_trna_charging</span><span class="p">(</span>
                <span class="n">bulk_state</span><span class="p">,</span>
                <span class="n">unique_molecules</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">variable_elongation_translation</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">cell_mass</span> <span class="o">=</span> <span class="n">calculate_cell_mass</span><span class="p">(</span><span class="n">bulk_state</span><span class="p">,</span> <span class="n">unique_molecules</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">)</span>
        <span class="n">set_small_molecule_counts</span><span class="p">(</span>
            <span class="n">bulk_state</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">,</span>
            <span class="n">media_id</span><span class="p">,</span>
            <span class="n">import_molecules</span><span class="p">,</span>
            <span class="n">mass_coeff</span><span class="p">,</span>
            <span class="n">cell_mass</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Numpy arrays are read-only outside of updaters for safety</span>
        <span class="n">bulk_state</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">unique_state</span> <span class="ow">in</span> <span class="n">unique_molecules</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">unique_state</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;bulk&quot;</span><span class="p">:</span> <span class="n">bulk_state</span><span class="p">,</span>
            <span class="s2">&quot;unique&quot;</span><span class="p">:</span> <span class="n">unique_molecules</span><span class="p">,</span>
            <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;exchange&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">mol</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="n">current_concentrations</span><span class="p">},</span>
                <span class="s2">&quot;exchange_data&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;unconstrained&quot;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">unconstrained</span><span class="p">),</span>
                    <span class="s2">&quot;constrained&quot;</span><span class="p">:</span> <span class="n">constrained</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="s2">&quot;media_id&quot;</span><span class="p">:</span> <span class="n">media_id</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;boundary&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;external&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="n">mol</span><span class="p">:</span> <span class="n">conc</span> <span class="o">*</span> <span class="n">vivunits</span><span class="o">.</span><span class="n">mM</span>
                    <span class="k">for</span> <span class="n">mol</span><span class="p">,</span> <span class="n">conc</span> <span class="ow">in</span> <span class="n">current_concentrations</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">}</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2025, The Vivarium E. coli Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>